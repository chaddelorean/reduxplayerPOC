!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__DO_NOT_USE__ActionTypes",(function(){return i})),r.d(t,"applyMiddleware",(function(){return b})),r.d(t,"bindActionCreators",(function(){return d})),r.d(t,"combineReducers",(function(){return s})),r.d(t,"compose",(function(){return h})),r.d(t,"createStore",(function(){return c}));var n=r(1),o=function(){return Math.random().toString(36).substring(7).split("").join(".")},i={INIT:"@@redux/INIT"+o(),REPLACE:"@@redux/REPLACE"+o(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+o()}};function a(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function c(e,t,r){var o;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(c)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var u=e,s=t,l=[],d=l,p=!1;function f(){d===l&&(d=l.slice())}function y(){if(p)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return s}function h(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(p)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return f(),d.push(e),function(){if(t){if(p)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,f();var r=d.indexOf(e);d.splice(r,1),l=null}}}function b(e){if(!a(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(p)throw new Error("Reducers may not dispatch actions.");try{p=!0,s=u(s,e)}finally{p=!1}for(var t=l=d,r=0;r<t.length;r++){(0,t[r])()}return e}function m(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");u=e,b({type:i.REPLACE})}function w(){var e,t=h;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(y())}return r(),{unsubscribe:t(r)}}})[n.a]=function(){return this},e}return b({type:i.INIT}),(o={dispatch:b,subscribe:h,getState:y,replaceReducer:m})[n.a]=w,o}function u(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function s(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];0,"function"==typeof e[o]&&(r[o]=e[o])}var a,c=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:i.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:i.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+i.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(e){a=e}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var n=!1,o={},i=0;i<c.length;i++){var s=c[i],l=r[s],d=e[s],p=l(d,t);if(void 0===p){var f=u(s,t);throw new Error(f)}o[s]=p,n=n||p!==d}return(n=n||c.length!==Object.keys(e).length)?o:e}}function l(e,t){return function(){return t(e.apply(this,arguments))}}function d(e,t){if("function"==typeof e)return l(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var r={};for(var n in e){var o=e[n];"function"==typeof o&&(r[n]=l(o,t))}return r}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(r,!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function b(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},i=t.map((function(e){return e(o)}));return y({},r,{dispatch:n=h.apply(void 0,i)(r.dispatch)})}}}},function(e,t,r){"use strict";(function(e,n){var o,i=r(2);o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:n;var a=Object(i.a)(o);t.a=a}).call(this,r(4),r(5)(e))},function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";var n=r(0).compose;t.__esModule=!0,t.composeWithDevTools="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?n:n.apply(null,arguments)},t.devToolsEnhancer="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){"use strict";r.r(t);const n="PLAYING",o="STOPPED",i="PAUSED",a="SEEKING",c="STALLED",u="ENDED",s="TIME_UPDATE",l="ABSOLUTE_TIME_UPDATE",d="SET_BEACON",p="CLEAR_BEACONS",f="PLAY_STATE",y="PAUSE_STATE",h="STALLED_STATE",b="SEEKING_STATE",m="STOPPED_STATE",w="NEXT_CLIP",v="PREV_CLIP",E="SWITCH_CLIP",g="CLIPLIST_UPDATE",T="CLIP_ENDED",O="SET_TIME_SHIFTABLE",S="defaultImpression",_="firstQuartile",I="midway",P="thirdQuartile",j="complete",x=e=>({type:l,payload:e}),A=e=>({type:d,payload:e}),L=e=>({type:O,payload:e}),k=()=>({type:h}),N=function(e){return 1e3*e};var C=r(0);let D=Object(C.combineReducers)({playerStateReducer:(e=o,t)=>{switch(t.type){case m:e=o;break;case f:e=n;break;case y:e=i;break;case h:e=c;break;case b:e=a;break;case T:e=u}return e},clipListReducer:(e={clipList:[],currentClipIndex:0},t)=>{switch(t.type){case w:e.currentClipIndex++;break;case v:e.currentClipIndex--;break;case E:e.currentClipIndex=t.clipIndex;break;case g:e=t.assetClipList}return e}});var R=r(3);const B=Object(R.composeWithDevTools)({realtime:!0}),U=Object(C.createStore)((e={apjsTime:0,playerTime:0,beacons:[],timeShiftable:!0},t)=>{switch(t.type){case s:e.apjsTime+=t.msIncrement,e.playerTime=t.playerTime;break;case l:e.apjsTime=t.payload,e.playerTime=t.payload;break;case d:let r=e.beacons.findIndex(e=>e.type===t.payload.type&&e.timeIndex===t.payload.timeIndex);-1!==r?e.beacons.splice(r,t.payload):e.beacons.push(t.payload);break;case p:e.beacons=[];break;case O:e.timeShiftable=t.payload}return e},B()),M=Object(C.createStore)(D,B());var X=[S,_,I,P,j];var F=function(){let e=function(){let e=U.getState().apjsTime,t=U.getState().beacons,r=t.filter(e=>!e.isFired);r&&Array.isArray(r)&&r.length>0&&r[0].timeIndex<=e&&(r[0].isFired=!0,U.dispatch(A(r[0])),U.dispatch(L(!1)),console.log("Beacon event fired: ",r[0]));let n=U.getState().timeShiftable,o=t.filter(e=>e.isFired);o&&Array.isArray(o)&&o.length>0&&!n&&o[o.length-1].timeIndex+15e3<=e&&U.dispatch(L(!0))};return{processBeacons:function(e){X.map(t=>{let r=0;switch(t){case S:r=0;break;case _:r=.25*e;break;case I:r=e/2;break;case P:r=.75*e;break;case j:r=e}let n={type:t,timeIndex:N(r),isFired:!1};U.dispatch(A(n))})},watchBeaconTimeline:function(){U.subscribe(e)}}}(),V=[{url:"https://media.w3.org/2010/05/sintel/trailer.mp4"},{url:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"},{url:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4"}];let W,K;function Y(e){let t=M.getState();if(t.clipListReducer){let r=t.clipListReducer.clipList,n=t.clipListReducer.currentClipIndex||0,o=document.createElement("source");o.type="video/mp4",o.src=r[n].url,e.innerHTML="",e.appendChild(o),n>0&&e.load()}}function G(){let e=U.getState().apjsTime,t=e/1e3;let r=U.getState().playerTime;e%1e3==0&&0!==e&&console.log(`1 second interval happened! APJSTime: ${e} ms PlayerTime: ${r} sec`),t%30==0&&0!==e&&console.log(`30 second interval happened! APJSTime: ${t} sec PlayerTime: ${r} sec`),t%60==0&&0!==e&&console.log(`1 minute interval happened! APJSTime: ${t} sec PlayerTime: ${r} sec`),t%300==0&&0!==e&&console.log(`5 minute interval happened! APJSTime: ${t} sec PlayerTime: ${r} sec`)}$((function(){W=document.getElementById("sampleVideoPlayer"),W.onplay=()=>{F.processBeacons(W.duration),M.dispatch({type:f}),K=window.setInterval(()=>{let e=U.getState().playerTime,t=W.currentTime,r=M.getState().playerState;t-e>1e4&&r!==c&&(console.error("Stall detected"),M.dispatch(k())),U.dispatch({type:s,msIncrement:100,playerTime:t})},100)},W.onpause=()=>{M.dispatch({type:y}),clearInterval(K)},W.onstalled=()=>{M.dispatch(k())},W.onseeking=()=>{M.dispatch({type:b})},W.onseeked=e=>{var t;U.dispatch(x((t=N(W.currentTime),100*Math.ceil(t/100))))},W.onended=()=>{M.dispatch({type:T});let e=M.getState();if(e){(e.clipListReducer.currentClipIndex||0)+1<e.clipListReducer.clipList.length&&(U.dispatch(x(0)),U.dispatch({type:p}),M.dispatch({type:w}),Y(W))}},W.onloadeddata=()=>{(M.getState().clipListReducer.currentClipIndex||0)>0&&W.play()},M.dispatch({type:g,assetClipList:{clipList:V,currentClipIndex:0}}),Y(W),U.subscribe(G),F.watchBeaconTimeline()}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3JlZHV4L2VzL3JlZHV4LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9zeW1ib2wtb2JzZXJ2YWJsZS9lcy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvc3ltYm9sLW9ic2VydmFibGUvZXMvcG9ueWZpbGwuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3JlZHV4LWRldnRvb2xzLWV4dGVuc2lvbi9pbmRleC5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vZ2xvYmFsLmpzIiwid2VicGFjazovLy8od2VicGFjaykvYnVpbGRpbi9oYXJtb255LW1vZHVsZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdHlwZXMvcGxheWVyRW51bXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FjdGlvbnMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzLmpzIiwid2VicGFjazovLy8uL3NyYy9yZWR1Y2Vycy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc3RvcmUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3R5cGVzL2JlYWNvbnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2JlYWNvblV0aWxzLmpzIiwid2VicGFjazovLy8uL3NyYy90eXBlcy9jbGlwTGlzdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsInJhbmRvbVN0cmluZyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0cmluZyIsInNwbGl0Iiwiam9pbiIsIkFjdGlvblR5cGVzIiwiSU5JVCIsIlJFUExBQ0UiLCJQUk9CRV9VTktOT1dOX0FDVElPTiIsImlzUGxhaW5PYmplY3QiLCJvYmoiLCJwcm90byIsImdldFByb3RvdHlwZU9mIiwiY3JlYXRlU3RvcmUiLCJyZWR1Y2VyIiwicHJlbG9hZGVkU3RhdGUiLCJlbmhhbmNlciIsIl9yZWYyIiwiYXJndW1lbnRzIiwiRXJyb3IiLCJ1bmRlZmluZWQiLCJjdXJyZW50UmVkdWNlciIsImN1cnJlbnRTdGF0ZSIsImN1cnJlbnRMaXN0ZW5lcnMiLCJuZXh0TGlzdGVuZXJzIiwiaXNEaXNwYXRjaGluZyIsImVuc3VyZUNhbk11dGF0ZU5leHRMaXN0ZW5lcnMiLCJzbGljZSIsImdldFN0YXRlIiwic3Vic2NyaWJlIiwibGlzdGVuZXIiLCJpc1N1YnNjcmliZWQiLCJwdXNoIiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiZGlzcGF0Y2giLCJhY3Rpb24iLCJ0eXBlIiwibGlzdGVuZXJzIiwibGVuZ3RoIiwicmVwbGFjZVJlZHVjZXIiLCJuZXh0UmVkdWNlciIsIm9ic2VydmFibGUiLCJfcmVmIiwib3V0ZXJTdWJzY3JpYmUiLCJvYnNlcnZlciIsIlR5cGVFcnJvciIsIm9ic2VydmVTdGF0ZSIsIm5leHQiLCJ1bnN1YnNjcmliZSIsInRoaXMiLCJnZXRVbmRlZmluZWRTdGF0ZUVycm9yTWVzc2FnZSIsImFjdGlvblR5cGUiLCJTdHJpbmciLCJjb21iaW5lUmVkdWNlcnMiLCJyZWR1Y2VycyIsInJlZHVjZXJLZXlzIiwia2V5cyIsImZpbmFsUmVkdWNlcnMiLCJzaGFwZUFzc2VydGlvbkVycm9yIiwiZmluYWxSZWR1Y2VyS2V5cyIsImZvckVhY2giLCJhc3NlcnRSZWR1Y2VyU2hhcGUiLCJlIiwic3RhdGUiLCJoYXNDaGFuZ2VkIiwibmV4dFN0YXRlIiwiX2kiLCJfa2V5IiwicHJldmlvdXNTdGF0ZUZvcktleSIsIm5leHRTdGF0ZUZvcktleSIsImVycm9yTWVzc2FnZSIsImJpbmRBY3Rpb25DcmVhdG9yIiwiYWN0aW9uQ3JlYXRvciIsImFwcGx5IiwiYmluZEFjdGlvbkNyZWF0b3JzIiwiYWN0aW9uQ3JlYXRvcnMiLCJib3VuZEFjdGlvbkNyZWF0b3JzIiwiX2RlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJvd25LZXlzIiwiZW51bWVyYWJsZU9ubHkiLCJnZXRPd25Qcm9wZXJ0eVN5bWJvbHMiLCJmaWx0ZXIiLCJzeW0iLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJfb2JqZWN0U3ByZWFkMiIsInRhcmdldCIsInNvdXJjZSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvcnMiLCJkZWZpbmVQcm9wZXJ0aWVzIiwiY29tcG9zZSIsIl9sZW4iLCJmdW5jcyIsIkFycmF5IiwiYXJnIiwicmVkdWNlIiwiYSIsImIiLCJhcHBseU1pZGRsZXdhcmUiLCJtaWRkbGV3YXJlcyIsInN0b3JlIiwiX2Rpc3BhdGNoIiwibWlkZGxld2FyZUFQSSIsImNoYWluIiwibWFwIiwibWlkZGxld2FyZSIsInJvb3QiLCJzZWxmIiwid2luZG93IiwiZ2xvYmFsIiwicmVzdWx0Iiwic3ltYm9sT2JzZXJ2YWJsZVBvbnlmaWxsIiwiY29tcG9zZVdpdGhEZXZUb29scyIsIl9fUkVEVVhfREVWVE9PTFNfRVhURU5TSU9OX0NPTVBPU0VfXyIsImRldlRvb2xzRW5oYW5jZXIiLCJfX1JFRFVYX0RFVlRPT0xTX0VYVEVOU0lPTl9fIiwibm9vcCIsImciLCJGdW5jdGlvbiIsIm9yaWdpbmFsTW9kdWxlIiwid2VicGFja1BvbHlmaWxsIiwiY2hpbGRyZW4iLCJwbGF5ZXJFbnVtcyIsInBsYXllckFjdGlvbnMiLCJiZWFjb25UeXBlcyIsInNldEFib3NsdXRlVGltZWxpbmUiLCJuZXdUaW1lIiwicGF5bG9hZCIsInNldEJlYWNvbiIsImJlYWNvbiIsInNldFRpbWVTaGlmdGFibGUiLCJ0aW1lU2hpZnRhYmxlIiwic3RhbGxlZFN0YXRlIiwiY29udmVydFRvTWlsbGlzZWNvbmRzIiwidGltZSIsImFwSlNSZWR1Y2VycyIsInBsYXllclN0YXRlUmVkdWNlciIsInBsYXllclN0YXRlIiwiY2xpcExpc3RSZWR1Y2VyIiwiYXNzZXRDbGlwTGlzdCIsImNsaXBMaXN0IiwiY3VycmVudENsaXBJbmRleCIsImNsaXBJbmRleCIsImNvbXBvc2VFbmhhbmNlcnMiLCJyZWFsdGltZSIsInRpbWVsaW5lU3RvcmUiLCJ0aW1lT2JqZWN0IiwiYXBqc1RpbWUiLCJwbGF5ZXJUaW1lIiwiYmVhY29ucyIsIm1zSW5jcmVtZW50IiwiZmluZEluZGV4IiwidGltZUluZGV4IiwiYXBqc1N0b3JlIiwiaGFuZGxlQmVhY29uVGltZWxpbmUiLCJjdXJyZW50QVBKU1RpbWVNUyIsInBlbmRpbmdCZWFjb25zIiwiaXNGaXJlZCIsImlzQXJyYXkiLCJjb25zb2xlIiwibG9nIiwiaXNUaW1lU2hpZnRhYmxlIiwibGFzdEZpcmVkQmVhY29uIiwicHJvY2Vzc0JlYWNvbnMiLCJhc3NldER1cmF0aW9uIiwiYmVhY29uVHlwZSIsIndhdGNoQmVhY29uVGltZWxpbmUiLCJ1cmwiLCJ0aW1lbGluZUludGVydmFsIiwibG9hZFZpZGVvU3JjIiwic2FtcGxlVmlkZW9QbGF5ZXIiLCJhcGpzU3RvcmVTdGF0ZSIsImNsaXBMaXN0RnJvbVN0b3JlIiwic291cmNlRWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInNyYyIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwibG9hZCIsIm9uVGltZVVwZGF0ZSIsImN1cnJlbnRBUEpTVGltZVNlY29uZHMiLCJjdXJyZW50UGxheWVyVGltZSIsIiQiLCJnZXRFbGVtZW50QnlJZCIsIm9ucGxheSIsImR1cmF0aW9uIiwic2V0SW50ZXJ2YWwiLCJwcmV2UGxheWVyVGltZSIsImN1cnJlbnRBUEpTVGltZSIsImN1cnJlbnRUaW1lIiwiY3VycmVudFBsYXllclN0YXRlIiwiZXJyb3IiLCJvbnBhdXNlIiwiY2xlYXJJbnRlcnZhbCIsIm9uc3RhbGxlZCIsIm9uc2Vla2luZyIsIm9uc2Vla2VkIiwiZXZlbnQiLCJjZWlsIiwib25lbmRlZCIsIm9ubG9hZGVkZGF0YSIsInBsYXkiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVBQWViLEVBQVMsYUFBYyxDQUFFbUIsT0FBTyxLQVF2RHJCLEVBQW9Cc0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFyQixFQUFvQnFCLElBQy9CLEVBQVBFLEVBQVUsT0FBT0YsRUFDcEIsR0FBVyxFQUFQRSxHQUE4QixpQkFBVkYsR0FBc0JBLEdBQVNBLEVBQU1HLFdBQVksT0FBT0gsRUFDaEYsSUFBSUksRUFBS1gsT0FBT1ksT0FBTyxNQUd2QixHQUZBMUIsRUFBb0JrQixFQUFFTyxHQUN0QlgsT0FBT0MsZUFBZVUsRUFBSSxVQUFXLENBQUVULFlBQVksRUFBTUssTUFBT0EsSUFDdEQsRUFBUEUsR0FBNEIsaUJBQVRGLEVBQW1CLElBQUksSUFBSU0sS0FBT04sRUFBT3JCLEVBQW9CVSxFQUFFZSxFQUFJRSxFQUFLLFNBQVNBLEdBQU8sT0FBT04sRUFBTU0sSUFBUUMsS0FBSyxLQUFNRCxJQUM5SSxPQUFPRixHQUlSekIsRUFBb0I2QixFQUFJLFNBQVMxQixHQUNoQyxJQUFJUyxFQUFTVCxHQUFVQSxFQUFPcUIsV0FDN0IsV0FBd0IsT0FBT3JCLEVBQWdCLFNBQy9DLFdBQThCLE9BQU9BLEdBRXRDLE9BREFILEVBQW9CVSxFQUFFRSxFQUFRLElBQUtBLEdBQzVCQSxHQUlSWixFQUFvQmEsRUFBSSxTQUFTaUIsRUFBUUMsR0FBWSxPQUFPakIsT0FBT2tCLFVBQVVDLGVBQWUxQixLQUFLdUIsRUFBUUMsSUFHekcvQixFQUFvQmtDLEVBQUksR0FJakJsQyxFQUFvQkEsRUFBb0JtQyxFQUFJLEcsK0JDbEZyRCxtVEFRSUMsRUFBZSxXQUNqQixPQUFPQyxLQUFLQyxTQUFTQyxTQUFTLElBQUlDLFVBQVUsR0FBR0MsTUFBTSxJQUFJQyxLQUFLLE1BRzVEQyxFQUFjLENBQ2hCQyxLQUFNLGVBQWlCUixJQUN2QlMsUUFBUyxrQkFBb0JULElBQzdCVSxxQkFBc0IsV0FDcEIsTUFBTywrQkFBaUNWLE1BUTVDLFNBQVNXLEVBQWNDLEdBQ3JCLEdBQW1CLGlCQUFSQSxHQUE0QixPQUFSQSxFQUFjLE9BQU8sRUFHcEQsSUFGQSxJQUFJQyxFQUFRRCxFQUU0QixPQUFqQ2xDLE9BQU9vQyxlQUFlRCxJQUMzQkEsRUFBUW5DLE9BQU9vQyxlQUFlRCxHQUdoQyxPQUFPbkMsT0FBT29DLGVBQWVGLEtBQVNDLEVBNkJ4QyxTQUFTRSxFQUFZQyxFQUFTQyxFQUFnQkMsR0FDNUMsSUFBSUMsRUFFSixHQUE4QixtQkFBbkJGLEdBQXFELG1CQUFiQyxHQUErQyxtQkFBYkEsR0FBbUQsbUJBQWpCRSxVQUFVLEdBQy9ILE1BQU0sSUFBSUMsTUFBTSx1SkFRbEIsR0FMOEIsbUJBQW5CSixRQUFxRCxJQUFiQyxJQUNqREEsRUFBV0QsRUFDWEEsT0FBaUJLLFFBR0ssSUFBYkosRUFBMEIsQ0FDbkMsR0FBd0IsbUJBQWJBLEVBQ1QsTUFBTSxJQUFJRyxNQUFNLDJDQUdsQixPQUFPSCxFQUFTSCxFQUFURyxDQUFzQkYsRUFBU0MsR0FHeEMsR0FBdUIsbUJBQVpELEVBQ1QsTUFBTSxJQUFJSyxNQUFNLDBDQUdsQixJQUFJRSxFQUFpQlAsRUFDakJRLEVBQWVQLEVBQ2ZRLEVBQW1CLEdBQ25CQyxFQUFnQkQsRUFDaEJFLEdBQWdCLEVBU3BCLFNBQVNDLElBQ0hGLElBQWtCRCxJQUNwQkMsRUFBZ0JELEVBQWlCSSxTQVVyQyxTQUFTQyxJQUNQLEdBQUlILEVBQ0YsTUFBTSxJQUFJTixNQUFNLHdNQUdsQixPQUFPRyxFQTJCVCxTQUFTTyxFQUFVQyxHQUNqQixHQUF3QixtQkFBYkEsRUFDVCxNQUFNLElBQUlYLE1BQU0sMkNBR2xCLEdBQUlNLEVBQ0YsTUFBTSxJQUFJTixNQUFNLDZUQUdsQixJQUFJWSxHQUFlLEVBR25CLE9BRkFMLElBQ0FGLEVBQWNRLEtBQUtGLEdBQ1osV0FDTCxHQUFLQyxFQUFMLENBSUEsR0FBSU4sRUFDRixNQUFNLElBQUlOLE1BQU0sa0tBR2xCWSxHQUFlLEVBQ2ZMLElBQ0EsSUFBSU8sRUFBUVQsRUFBY1UsUUFBUUosR0FDbENOLEVBQWNXLE9BQU9GLEVBQU8sR0FDNUJWLEVBQW1CLE9BOEJ2QixTQUFTYSxFQUFTQyxHQUNoQixJQUFLNUIsRUFBYzRCLEdBQ2pCLE1BQU0sSUFBSWxCLE1BQU0sMkVBR2xCLFFBQTJCLElBQWhCa0IsRUFBT0MsS0FDaEIsTUFBTSxJQUFJbkIsTUFBTSxzRkFHbEIsR0FBSU0sRUFDRixNQUFNLElBQUlOLE1BQU0sc0NBR2xCLElBQ0VNLEdBQWdCLEVBQ2hCSCxFQUFlRCxFQUFlQyxFQUFjZSxHQUM1QyxRQUNBWixHQUFnQixFQUtsQixJQUZBLElBQUljLEVBQVloQixFQUFtQkMsRUFFMUIxRCxFQUFJLEVBQUdBLEVBQUl5RSxFQUFVQyxPQUFRMUUsSUFBSyxFQUV6Q2dFLEVBRGVTLEVBQVV6RSxNQUkzQixPQUFPdUUsRUFjVCxTQUFTSSxFQUFlQyxHQUN0QixHQUEyQixtQkFBaEJBLEVBQ1QsTUFBTSxJQUFJdkIsTUFBTSw4Q0FHbEJFLEVBQWlCcUIsRUFLakJOLEVBQVMsQ0FDUEUsS0FBTWpDLEVBQVlFLFVBV3RCLFNBQVNvQyxJQUNQLElBQUlDLEVBRUFDLEVBQWlCaEIsRUFDckIsT0FBT2UsRUFBTyxDQVNaZixVQUFXLFNBQW1CaUIsR0FDNUIsR0FBd0IsaUJBQWJBLEdBQXNDLE9BQWJBLEVBQ2xDLE1BQU0sSUFBSUMsVUFBVSwwQ0FHdEIsU0FBU0MsSUFDSEYsRUFBU0csTUFDWEgsRUFBU0csS0FBS3JCLEtBTWxCLE9BRkFvQixJQUVPLENBQ0xFLFlBRmdCTCxFQUFlRyxPQUs3QixLQUFnQixXQUN0QixPQUFPRyxNQUNOUCxFQVNMLE9BSEFSLEVBQVMsQ0FDUEUsS0FBTWpDLEVBQVlDLFFBRWJXLEVBQVEsQ0FDYm1CLFNBQVVBLEVBQ1ZQLFVBQVdBLEVBQ1hELFNBQVVBLEVBQ1ZhLGVBQWdCQSxJQUNULEtBQWdCRSxFQUFZMUIsRUEwQnZDLFNBQVNtQyxFQUE4Qi9ELEVBQUtnRCxHQUMxQyxJQUFJZ0IsRUFBYWhCLEdBQVVBLEVBQU9DLEtBRWxDLE1BQU8sVUFEaUJlLEdBQWMsV0FBY0MsT0FBT0QsR0FBYyxLQUFRLGFBQzNDLGNBQWlCaEUsRUFBaEQsaUxBZ0VULFNBQVNrRSxFQUFnQkMsR0FJdkIsSUFIQSxJQUFJQyxFQUFjakYsT0FBT2tGLEtBQUtGLEdBQzFCRyxFQUFnQixHQUVYN0YsRUFBSSxFQUFHQSxFQUFJMkYsRUFBWWpCLE9BQVExRSxJQUFLLENBQzNDLElBQUl1QixFQUFNb0UsRUFBWTNGLEdBRWxCLEVBTXlCLG1CQUFsQjBGLEVBQVNuRSxLQUNsQnNFLEVBQWN0RSxHQUFPbUUsRUFBU25FLElBSWxDLElBU0l1RSxFQVRBQyxFQUFtQnJGLE9BQU9rRixLQUFLQyxHQVduQyxLQWpFRixTQUE0QkgsR0FDMUJoRixPQUFPa0YsS0FBS0YsR0FBVU0sU0FBUSxTQUFVekUsR0FDdEMsSUFBSXlCLEVBQVUwQyxFQUFTbkUsR0FLdkIsUUFBNEIsSUFKVHlCLE9BQVFNLEVBQVcsQ0FDcENrQixLQUFNakMsRUFBWUMsT0FJbEIsTUFBTSxJQUFJYSxNQUFNLFlBQWU5QixFQUFmLGlSQUdsQixRQUVPLElBRkl5QixPQUFRTSxFQUFXLENBQzVCa0IsS0FBTWpDLEVBQVlHLHlCQUVsQixNQUFNLElBQUlXLE1BQU0sWUFBZTlCLEVBQWYsNkVBQTBHZ0IsRUFBWUMsS0FBdEgsa1RBb0RsQnlELENBQW1CSixHQUNuQixNQUFPSyxHQUNQSixFQUFzQkksRUFHeEIsT0FBTyxTQUFxQkMsRUFBTzVCLEdBS2pDLFFBSmMsSUFBVjRCLElBQ0ZBLEVBQVEsSUFHTkwsRUFDRixNQUFNQSxFQWNSLElBWDJDLElBUXZDTSxHQUFhLEVBQ2JDLEVBQVksR0FFUEMsRUFBSyxFQUFHQSxFQUFLUCxFQUFpQnJCLE9BQVE0QixJQUFNLENBQ25ELElBQUlDLEVBQU9SLEVBQWlCTyxHQUN4QnRELEVBQVU2QyxFQUFjVSxHQUN4QkMsRUFBc0JMLEVBQU1JLEdBQzVCRSxFQUFrQnpELEVBQVF3RCxFQUFxQmpDLEdBRW5ELFFBQStCLElBQXBCa0MsRUFBaUMsQ0FDMUMsSUFBSUMsRUFBZXBCLEVBQThCaUIsRUFBTWhDLEdBQ3ZELE1BQU0sSUFBSWxCLE1BQU1xRCxHQUdsQkwsRUFBVUUsR0FBUUUsRUFDbEJMLEVBQWFBLEdBQWNLLElBQW9CRCxFQUlqRCxPQURBSixFQUFhQSxHQUFjTCxFQUFpQnJCLFNBQVdoRSxPQUFPa0YsS0FBS08sR0FBT3pCLFFBQ3REMkIsRUFBWUYsR0FJcEMsU0FBU1EsRUFBa0JDLEVBQWV0QyxHQUN4QyxPQUFPLFdBQ0wsT0FBT0EsRUFBU3NDLEVBQWNDLE1BQU14QixLQUFNakMsYUEwQjlDLFNBQVMwRCxFQUFtQkMsRUFBZ0J6QyxHQUMxQyxHQUE4QixtQkFBbkJ5QyxFQUNULE9BQU9KLEVBQWtCSSxFQUFnQnpDLEdBRzNDLEdBQThCLGlCQUFuQnlDLEdBQWtELE9BQW5CQSxFQUN4QyxNQUFNLElBQUkxRCxNQUFNLDBFQUErRixPQUFuQjBELEVBQTBCLGNBQWdCQSxHQUF0SCw4RkFHbEIsSUFBSUMsRUFBc0IsR0FFMUIsSUFBSyxJQUFJekYsS0FBT3dGLEVBQWdCLENBQzlCLElBQUlILEVBQWdCRyxFQUFleEYsR0FFTixtQkFBbEJxRixJQUNUSSxFQUFvQnpGLEdBQU9vRixFQUFrQkMsRUFBZXRDLElBSWhFLE9BQU8wQyxFQUdULFNBQVNDLEVBQWdCckUsRUFBS3JCLEVBQUtOLEdBWWpDLE9BWElNLEtBQU9xQixFQUNUbEMsT0FBT0MsZUFBZWlDLEVBQUtyQixFQUFLLENBQzlCTixNQUFPQSxFQUNQTCxZQUFZLEVBQ1pzRyxjQUFjLEVBQ2RDLFVBQVUsSUFHWnZFLEVBQUlyQixHQUFPTixFQUdOMkIsRUFHVCxTQUFTd0UsRUFBUTFGLEVBQVEyRixHQUN2QixJQUFJekIsRUFBT2xGLE9BQU9rRixLQUFLbEUsR0FTdkIsT0FQSWhCLE9BQU80Ryx1QkFDVDFCLEVBQUsxQixLQUFLMkMsTUFBTWpCLEVBQU1sRixPQUFPNEcsc0JBQXNCNUYsSUFHakQyRixJQUFnQnpCLEVBQU9BLEVBQUsyQixRQUFPLFNBQVVDLEdBQy9DLE9BQU85RyxPQUFPK0cseUJBQXlCL0YsRUFBUThGLEdBQUs1RyxlQUUvQ2dGLEVBR1QsU0FBUzhCLEVBQWVDLEdBQ3RCLElBQUssSUFBSTNILEVBQUksRUFBR0EsRUFBSW9ELFVBQVVzQixPQUFRMUUsSUFBSyxDQUN6QyxJQUFJNEgsRUFBeUIsTUFBaEJ4RSxVQUFVcEQsR0FBYW9ELFVBQVVwRCxHQUFLLEdBRS9DQSxFQUFJLEVBQ05vSCxFQUFRUSxHQUFRLEdBQU01QixTQUFRLFNBQVV6RSxHQUN0QzBGLEVBQWdCVSxFQUFRcEcsRUFBS3FHLEVBQU9yRyxPQUU3QmIsT0FBT21ILDBCQUNoQm5ILE9BQU9vSCxpQkFBaUJILEVBQVFqSCxPQUFPbUgsMEJBQTBCRCxJQUVqRVIsRUFBUVEsR0FBUTVCLFNBQVEsU0FBVXpFLEdBQ2hDYixPQUFPQyxlQUFlZ0gsRUFBUXBHLEVBQUtiLE9BQU8rRyx5QkFBeUJHLEVBQVFyRyxPQUtqRixPQUFPb0csRUFhVCxTQUFTSSxJQUNQLElBQUssSUFBSUMsRUFBTzVFLFVBQVVzQixPQUFRdUQsRUFBUSxJQUFJQyxNQUFNRixHQUFPekIsRUFBTyxFQUFHQSxFQUFPeUIsRUFBTXpCLElBQ2hGMEIsRUFBTTFCLEdBQVFuRCxVQUFVbUQsR0FHMUIsT0FBcUIsSUFBakIwQixFQUFNdkQsT0FDRCxTQUFVeUQsR0FDZixPQUFPQSxHQUlVLElBQWpCRixFQUFNdkQsT0FDRHVELEVBQU0sR0FHUkEsRUFBTUcsUUFBTyxTQUFVQyxFQUFHQyxHQUMvQixPQUFPLFdBQ0wsT0FBT0QsRUFBRUMsRUFBRXpCLFdBQU0sRUFBUXpELGdCQXNCL0IsU0FBU21GLElBQ1AsSUFBSyxJQUFJUCxFQUFPNUUsVUFBVXNCLE9BQVE4RCxFQUFjLElBQUlOLE1BQU1GLEdBQU96QixFQUFPLEVBQUdBLEVBQU95QixFQUFNekIsSUFDdEZpQyxFQUFZakMsR0FBUW5ELFVBQVVtRCxHQUdoQyxPQUFPLFNBQVV4RCxHQUNmLE9BQU8sV0FDTCxJQUFJMEYsRUFBUTFGLEVBQVk4RCxXQUFNLEVBQVF6RCxXQUVsQ3NGLEVBQVksV0FDZCxNQUFNLElBQUlyRixNQUFNLDJIQUdkc0YsRUFBZ0IsQ0FDbEI3RSxTQUFVMkUsRUFBTTNFLFNBQ2hCUSxTQUFVLFdBQ1IsT0FBT29FLEVBQVU3QixXQUFNLEVBQVF6RCxhQUcvQndGLEVBQVFKLEVBQVlLLEtBQUksU0FBVUMsR0FDcEMsT0FBT0EsRUFBV0gsTUFHcEIsT0FBT2pCLEVBQWUsR0FBSWUsRUFBTyxDQUMvQm5FLFNBRkZvRSxFQUFZWCxFQUFRbEIsV0FBTSxFQUFRK0IsRUFBdEJiLENBQTZCVSxFQUFNbkUsZ0IsOEJDbm9CckQsa0JBR0l5RSxFQUhKLE9BTUVBLEVBRGtCLG9CQUFUQyxLQUNGQSxLQUNvQixvQkFBWEMsT0FDVEEsWUFDb0IsSUFBWEMsRUFDVEEsRUFFQW5KLEVBS1QsSUFBSW9KLEVBQVMsWUFBU0osR0FDUCxRLHNEQ2xCQSxTQUFTSyxFQUF5QkwsR0FDaEQsSUFBSUksRUFDQXBJLEVBQVNnSSxFQUFLaEksT0FhbEIsTUFYc0IsbUJBQVhBLEVBQ05BLEVBQU84RCxXQUNWc0UsRUFBU3BJLEVBQU84RCxZQUVoQnNFLEVBQVNwSSxFQUFPLGNBQ2hCQSxFQUFPOEQsV0FBYXNFLEdBR3JCQSxFQUFTLGVBR0hBLEVBZlIsbUMsNkJDRUEsSUFBSXBCLEVBQVUsRUFBUSxHQUFTQSxRQUUvQmpJLEVBQVFzQixZQUFhLEVBQ3JCdEIsRUFBUXVKLG9CQUNZLG9CQUFYSixRQUEwQkEsT0FBT0sscUNBQ3RDTCxPQUFPSyxxQ0FDUCxXQUNFLEdBQXlCLElBQXJCbEcsVUFBVXNCLE9BQ2QsTUFBNEIsaUJBQWpCdEIsVUFBVSxHQUF3QjJFLEVBQ3RDQSxFQUFRbEIsTUFBTSxLQUFNekQsWUFJakN0RCxFQUFReUosaUJBQ1ksb0JBQVhOLFFBQTBCQSxPQUFPTyw2QkFDdENQLE9BQU9PLDZCQUNQLFdBQWEsT0FBTyxTQUFTQyxHQUFRLE9BQU9BLEssY0NsQmhELElBQUlDLEVBR0pBLEVBQUksV0FDSCxPQUFPckUsS0FESixHQUlKLElBRUNxRSxFQUFJQSxHQUFLLElBQUlDLFNBQVMsY0FBYixHQUNSLE1BQU96RCxHQUVjLGlCQUFYK0MsU0FBcUJTLEVBQUlULFFBT3JDbEosRUFBT0QsUUFBVTRKLEcsY0NuQmpCM0osRUFBT0QsUUFBVSxTQUFTOEosR0FDekIsSUFBS0EsRUFBZUMsZ0JBQWlCLENBQ3BDLElBQUk5SixFQUFTVyxPQUFPWSxPQUFPc0ksR0FFdEI3SixFQUFPK0osV0FBVS9KLEVBQU8rSixTQUFXLElBQ3hDcEosT0FBT0MsZUFBZVosRUFBUSxTQUFVLENBQ3ZDYSxZQUFZLEVBQ1pDLElBQUssV0FDSixPQUFPZCxFQUFPRSxLQUdoQlMsT0FBT0MsZUFBZVosRUFBUSxLQUFNLENBQ25DYSxZQUFZLEVBQ1pDLElBQUssV0FDSixPQUFPZCxFQUFPQyxLQUdoQlUsT0FBT0MsZUFBZVosRUFBUSxVQUFXLENBQ3hDYSxZQUFZLElBRWJiLEVBQU84SixnQkFBa0IsRUFFMUIsT0FBTzlKLEksb0NDdEJSLE1BQU1nSyxFQUNPLFVBRFBBLEVBRU8sVUFGUEEsRUFHTSxTQUhOQSxFQUlPLFVBSlBBLEVBS08sVUFMUEEsRUFNSyxRQUdMQyxFQUNXLGNBRFhBLEVBRW9CLHVCQUZwQkEsRUFHVSxhQUhWQSxFQUlhLGdCQUpiQSxFQUtVLGFBTFZBLEVBTVcsY0FOWEEsRUFPYSxnQkFQYkEsRUFRYSxnQkFSYkEsRUFTYSxnQkFUYkEsRUFVUyxZQVZUQSxFQVdTLFlBWFRBLEVBWVcsY0FaWEEsRUFhZSxrQkFiZkEsRUFjVSxhQWRWQSxFQWVrQixxQkFHbEJDLEVBQ2tCLG9CQURsQkEsRUFFYyxnQkFGZEEsRUFHTSxTQUhOQSxFQUljLGdCQUpkQSxFQUtRLFdDeEJSQyxFQUF1QkMsSUFBWSxDQUNyQzNGLEtBQU13RixFQUNOSSxRQUFTRCxJQUdQRSxFQUFhQyxJQUFXLENBQzFCOUYsS0FBTXdGLEVBQ05JLFFBQVNFLElBT1BDLEVBQW9CQyxJQUFrQixDQUN4Q2hHLEtBQU13RixFQUNOSSxRQUFTSSxJQVdQQyxFQUFlLEtBQU0sQ0FDdkJqRyxLQUFNd0YsSUNoQ0pVLEVBQXdCLFNBQVNDLEdBQ25DLE9BQWMsSUFBUEEsRyxXQ3NFWCxJQUFJQyxFQUFlLDBCQUFnQixDQUMvQkMsbUJBNUN1QixDQUFDQyxFQUFjZixFQUFxQnhGLEtBQzNELE9BQVFBLEVBQU9DLE1BQ1gsS0FBS3dGLEVBQ0RjLEVBQWNmLEVBQ2QsTUFDSixLQUFLQyxFQUNEYyxFQUFjZixFQUNkLE1BQ0osS0FBS0MsRUFDRGMsRUFBY2YsRUFDZCxNQUNKLEtBQUtDLEVBQ0RjLEVBQWNmLEVBQ2QsTUFDSixLQUFLQyxFQUNEYyxFQUFjZixFQUNkLE1BQ0osS0FBS0MsRUFDRGMsRUFBY2YsRUFHdEIsT0FBT2UsR0F3QlBDLGdCQXJCb0IsQ0FBQ0MsRUFBZ0IsQ0FBQ0MsU0FBVSxHQUFJQyxpQkFBa0IsR0FBSTNHLEtBQzFFLE9BQVFBLEVBQU9DLE1BQ1gsS0FBS3dGLEVBQ0RnQixFQUFjRSxtQkFDZCxNQUNKLEtBQUtsQixFQUNEZ0IsRUFBY0UsbUJBQ2QsTUFDSixLQUFLbEIsRUFDRGdCLEVBQWNFLGlCQUFtQjNHLEVBQU80RyxVQUN4QyxNQUNKLEtBQUtuQixFQUNEZ0IsRUFBZ0J6RyxFQUFPeUcsY0FJL0IsT0FBT0EsSyxXQ3BFWCxNQUFNSSxFQUFtQiw4QkFBb0IsQ0FBRUMsVUFBVSxJQUNuREMsRUFBZ0Isc0JERkUsQ0FBQ0MsRUFBYSxDQUFDQyxTQUFVLEVBQUdDLFdBQVksRUFBR0MsUUFBUyxHQUFJbEIsZUFBZSxHQUFPakcsS0FDbEcsT0FBUUEsRUFBT0MsTUFDWCxLQUFLd0YsRUFDRHVCLEVBQVdDLFVBQVlqSCxFQUFPb0gsWUFDOUJKLEVBQVdFLFdBQWFsSCxFQUFPa0gsV0FDL0IsTUFDSixLQUFLekIsRUFDRHVCLEVBQVdDLFNBQVdqSCxFQUFPNkYsUUFDN0JtQixFQUFXRSxXQUFhbEgsRUFBTzZGLFFBQy9CLE1BQ0osS0FBS0osRUFDRCxJQUFJN0YsRUFBUW9ILEVBQVdHLFFBQVFFLFVBQVV0QixHQUFVQSxFQUFPOUYsT0FBU0QsRUFBTzZGLFFBQVE1RixNQUFROEYsRUFBT3VCLFlBQWN0SCxFQUFPNkYsUUFBUXlCLFlBQy9HLElBQVgxSCxFQUNBb0gsRUFBV0csUUFBUXJILE9BQU9GLEVBQU9JLEVBQU82RixTQUV4Q21CLEVBQVdHLFFBQVF4SCxLQUFLSyxFQUFPNkYsU0FFbkMsTUFDSixLQUFLSixFQUNEdUIsRUFBV0csUUFBVSxHQUNyQixNQUNKLEtBQUsxQixFQUNEdUIsRUFBV2YsY0FBZ0JqRyxFQUFPNkYsUUFJMUMsT0FBT21CLEdDeEJ3Q0gsS0FDN0NVLEVBQVksc0JBQVlsQixFQUFjUSxLQ0g3QixPQUNYbkIsRUFDQUEsRUFDQUEsRUFDQUEsRUFDQUEsR0NnRVcsTUFoRUcsV0FFZCxJQUFJOEIsRUFBdUIsV0FDdkIsSUFBSUMsRUFBb0JWLEVBQWN4SCxXQUFXMEgsU0FDN0NFLEVBQVVKLEVBQWN4SCxXQUFXNEgsUUFDbkNPLEVBQWlCUCxFQUFRbkUsT0FBTytDLElBQVdBLEVBQU80QixTQUNsREQsR0FBa0IvRCxNQUFNaUUsUUFBUUYsSUFBbUJBLEVBQWV2SCxPQUFTLEdBQ3ZFdUgsRUFBZSxHQUFHSixXQUFhRyxJQUMvQkMsRUFBZSxHQUFHQyxTQUFVLEVBQzVCWixFQUFjaEgsU0FBUytGLEVBQVU0QixFQUFlLEtBQ2hEWCxFQUFjaEgsU0FBU2lHLEdBQWlCLElBQ3hDNkIsUUFBUUMsSUFBSSx1QkFBd0JKLEVBQWUsS0FJM0QsSUFBSUssRUFBa0JoQixFQUFjeEgsV0FBVzBHLGNBQzNDK0IsRUFBa0JiLEVBQVFuRSxPQUFPK0MsR0FBVUEsRUFBTzRCLFNBQ2xESyxHQUFtQnJFLE1BQU1pRSxRQUFRSSxJQUFvQkEsRUFBZ0I3SCxPQUFTLElBQU00SCxHQUNoRkMsRUFBZ0JBLEVBQWdCN0gsT0FBUyxHQUFHbUgsVUFwQi9CLE1Bb0JtRUcsR0FDaEZWLEVBQWNoSCxTQUFTaUcsR0FBaUIsS0F1Q3BELE1BQU8sQ0FDSGlDLGVBL0JpQixTQUFTQyxHQUMxQixFQUFRNUQsSUFBSTZELElBQ1IsSUFBSWIsRUFBWSxFQUNoQixPQUFRYSxHQUNKLEtBQUt6QyxFQUNENEIsRUFBWSxFQUNaLE1BQ0osS0FBSzVCLEVBQ0Q0QixFQUE0QixJQUFoQlksRUFDWixNQUNKLEtBQUt4QyxFQUNENEIsRUFBWVksRUFBZ0IsRUFDNUIsTUFDSixLQUFLeEMsRUFDRDRCLEVBQTRCLElBQWhCWSxFQUNaLE1BQ0osS0FBS3hDLEVBQ0Q0QixFQUFZWSxFQUlwQixJQUFJbkMsRUFBUyxDQUNUOUYsS0FBTWtJLEVBQ05iLFVBQVduQixFQUFzQm1CLEdBQ2pDSyxTQUFTLEdBRWJaLEVBQWNoSCxTQUFTK0YsRUFBVUMsT0FNckNxQyxvQkFwQ3NCLFdBQ3RCckIsRUFBY3ZILFVBQVVnSSxLQXpCZCxHQ1JILEdBQ1gsQ0FDSWEsSUFBSyxtREFFVCxDQUNJQSxJQUFLLHFGQUVULENBQ0lBLElBQUssd0ZDQ2IsSUFBSSxFQUNBQyxFQWtESixTQUFTQyxFQUFhQyxHQUNsQixJQUFJQyxFQUFpQmxCLEVBQVVoSSxXQUMvQixHQUFJa0osRUFBZWpDLGdCQUFpQixDQUNoQyxJQUFJa0MsRUFBb0JELEVBQWVqQyxnQkFBZ0JFLFNBQ25EQyxFQUFtQjhCLEVBQWVqQyxnQkFBZ0JHLGtCQUFvQixFQUN0RWdDLEVBQWdCQyxTQUFTQyxjQUFjLFVBQzNDRixFQUFjMUksS0FBTyxZQUNyQjBJLEVBQWNHLElBQU1KLEVBQWtCL0IsR0FBa0IwQixJQUN4REcsRUFBa0JPLFVBQVksR0FDOUJQLEVBQWtCUSxZQUFZTCxHQUMxQmhDLEVBQW1CLEdBQ25CNkIsRUFBa0JTLFFBa0I5QixTQUFTQyxJQUNMLElBQUl6QixFQUFvQlYsRUFBY3hILFdBQVcwSCxTQUM3Q2tDLEVBQTBDMUIsRU5sRmhDLElNbUZkLElBQUkyQixFQUFvQnJDLEVBQWN4SCxXQUFXMkgsV0FFN0NPLEVBQW9CLEtBQVMsR0FBMkIsSUFBdEJBLEdBQ2xDSSxRQUFRQyxJQUFJLHlDQUF5Q0wsb0JBQW9DMkIsU0FHekZELEVBQXlCLElBQU8sR0FBMkIsSUFBdEIxQixHQUNyQ0ksUUFBUUMsSUFBSSwwQ0FBMENxQixxQkFBMENDLFNBR2hHRCxFQUF5QixJQUFPLEdBQTJCLElBQXRCMUIsR0FDckNJLFFBQVFDLElBQUkseUNBQXlDcUIscUJBQTBDQyxTQUcvRkQsRUFBeUIsS0FBUSxHQUEyQixJQUF0QjFCLEdBQ3RDSSxRQUFRQyxJQUFJLHlDQUF5Q3FCLHFCQUEwQ0MsU0EvRnZHQyxHQUFFLFdBQ0UsRUFBb0JULFNBQVNVLGVBQWUscUJBQzVDLEVBQWtCQyxPQUFTLEtBQ3ZCLEVBQVl0QixlQUFlLEVBQWtCdUIsVUFDN0NqQyxFQUFVeEgsU1BXTSxDQUNwQkUsS0FBTXdGLElPaURONkMsRUFBbUI1RCxPQUFPK0UsWUFBWSxLQUNsQyxJQUFJQyxFQUFpQjNDLEVBQWN4SCxXQUFXMkgsV0FDMUN5QyxFQUFrQixFQUFrQkMsWUFDcENDLEVBQXFCdEMsRUFBVWhJLFdBQVdnSCxZQUN6Q29ELEVBQWtCRCxFQXpFTCxLQXlFNENHLElBQXVCckUsSUFDakZxQyxRQUFRaUMsTUFBTSxrQkFDZHZDLEVBQVV4SCxTQUFTbUcsTUFFdkJhLEVBQWNoSCxTUG5GMEIsQ0FDNUNFLEtBQU13RixFQUNOMkIsWU9HaUIsSVBGakJGLFdPZ0ZvRHlDLEtBOUVuQyxNQVlqQixFQUFrQkksUUFBVSxLQUN4QnhDLEVBQVV4SCxTUFdPLENBQ3JCRSxLQUFNd0YsSU9YRnVFLGNBQWMxQixJQUVsQixFQUFrQjJCLFVBQVksS0FDMUIxQyxFQUFVeEgsU0FBU21HLE1BRXZCLEVBQWtCZ0UsVUFBWSxLQUMxQjNDLEVBQVV4SCxTUGdCUyxDQUN2QkUsS0FBTXdGLEtPZk4sRUFBa0IwRSxTQUFZQyxJTjdCUCxJQUFTbEQsRU04QjVCSCxFQUFjaEgsU0FBUzRGLEdOOUJLdUIsRU04QmtDZixFQUFzQixFQUFrQnlELGFON0J2RSxJQUE1QmxNLEtBQUsyTSxLQUFLbkQsRUFBVyxTTStCNUIsRUFBa0JvRCxRQUFVLEtBQ3hCL0MsRUFBVXhILFNQMkJNLENBQ3BCRSxLQUFNd0YsSU8zQkYsSUFBSWdELEVBQWlCbEIsRUFBVWhJLFdBQy9CLEdBQUlrSixFQUFnQixFQUNPQSxFQUFlakMsZ0JBQWdCRyxrQkFBb0IsR0FFbkQsRUFEQzhCLEVBQWVqQyxnQkFBZ0JFLFNBQ1Z2RyxTQUN6QzRHLEVBQWNoSCxTQUFTNEYsRUFBb0IsSUFDM0NvQixFQUFjaEgsU1B0QkgsQ0FDdkJFLEtBQU13RixJT3NCTThCLEVBQVV4SCxTUE1ILENBQ25CRSxLQUFNd0YsSU9OTThDLEVBQWEsTUFJekIsRUFBa0JnQyxhQUFlLE1BQ1JoRCxFQUFVaEksV0FDT2lILGdCQUFnQkcsa0JBQW9CLEdBQ25ELEdBQ25CLEVBQWtCNkQsUUFJMUJqRCxFQUFVeEgsU1BVeUMsQ0FDbkRFLEtBQU13RixFQUNOZ0IsY0FBZSxDQUNYQyxTT2I4QixFUGM5QkMsaUJPZHdDLEtBQzVDNEIsRUFBYSxHQUNieEIsRUFBY3ZILFVBQVUwSixHQUN4QixFQUFZZCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDYpO1xuIiwiaW1wb3J0ICQkb2JzZXJ2YWJsZSBmcm9tICdzeW1ib2wtb2JzZXJ2YWJsZSc7XG5cbi8qKlxuICogVGhlc2UgYXJlIHByaXZhdGUgYWN0aW9uIHR5cGVzIHJlc2VydmVkIGJ5IFJlZHV4LlxuICogRm9yIGFueSB1bmtub3duIGFjdGlvbnMsIHlvdSBtdXN0IHJldHVybiB0aGUgY3VycmVudCBzdGF0ZS5cbiAqIElmIHRoZSBjdXJyZW50IHN0YXRlIGlzIHVuZGVmaW5lZCwgeW91IG11c3QgcmV0dXJuIHRoZSBpbml0aWFsIHN0YXRlLlxuICogRG8gbm90IHJlZmVyZW5jZSB0aGVzZSBhY3Rpb24gdHlwZXMgZGlyZWN0bHkgaW4geW91ciBjb2RlLlxuICovXG52YXIgcmFuZG9tU3RyaW5nID0gZnVuY3Rpb24gcmFuZG9tU3RyaW5nKCkge1xuICByZXR1cm4gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDcpLnNwbGl0KCcnKS5qb2luKCcuJyk7XG59O1xuXG52YXIgQWN0aW9uVHlwZXMgPSB7XG4gIElOSVQ6IFwiQEByZWR1eC9JTklUXCIgKyByYW5kb21TdHJpbmcoKSxcbiAgUkVQTEFDRTogXCJAQHJlZHV4L1JFUExBQ0VcIiArIHJhbmRvbVN0cmluZygpLFxuICBQUk9CRV9VTktOT1dOX0FDVElPTjogZnVuY3Rpb24gUFJPQkVfVU5LTk9XTl9BQ1RJT04oKSB7XG4gICAgcmV0dXJuIFwiQEByZWR1eC9QUk9CRV9VTktOT1dOX0FDVElPTlwiICsgcmFuZG9tU3RyaW5nKCk7XG4gIH1cbn07XG5cbi8qKlxuICogQHBhcmFtIHthbnl9IG9iaiBUaGUgb2JqZWN0IHRvIGluc3BlY3QuXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgYXJndW1lbnQgYXBwZWFycyB0byBiZSBhIHBsYWluIG9iamVjdC5cbiAqL1xuZnVuY3Rpb24gaXNQbGFpbk9iamVjdChvYmopIHtcbiAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnIHx8IG9iaiA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICB2YXIgcHJvdG8gPSBvYmo7XG5cbiAgd2hpbGUgKE9iamVjdC5nZXRQcm90b3R5cGVPZihwcm90bykgIT09IG51bGwpIHtcbiAgICBwcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihwcm90byk7XG4gIH1cblxuICByZXR1cm4gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaikgPT09IHByb3RvO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBSZWR1eCBzdG9yZSB0aGF0IGhvbGRzIHRoZSBzdGF0ZSB0cmVlLlxuICogVGhlIG9ubHkgd2F5IHRvIGNoYW5nZSB0aGUgZGF0YSBpbiB0aGUgc3RvcmUgaXMgdG8gY2FsbCBgZGlzcGF0Y2goKWAgb24gaXQuXG4gKlxuICogVGhlcmUgc2hvdWxkIG9ubHkgYmUgYSBzaW5nbGUgc3RvcmUgaW4geW91ciBhcHAuIFRvIHNwZWNpZnkgaG93IGRpZmZlcmVudFxuICogcGFydHMgb2YgdGhlIHN0YXRlIHRyZWUgcmVzcG9uZCB0byBhY3Rpb25zLCB5b3UgbWF5IGNvbWJpbmUgc2V2ZXJhbCByZWR1Y2Vyc1xuICogaW50byBhIHNpbmdsZSByZWR1Y2VyIGZ1bmN0aW9uIGJ5IHVzaW5nIGBjb21iaW5lUmVkdWNlcnNgLlxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlZHVjZXIgQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIG5leHQgc3RhdGUgdHJlZSwgZ2l2ZW5cbiAqIHRoZSBjdXJyZW50IHN0YXRlIHRyZWUgYW5kIHRoZSBhY3Rpb24gdG8gaGFuZGxlLlxuICpcbiAqIEBwYXJhbSB7YW55fSBbcHJlbG9hZGVkU3RhdGVdIFRoZSBpbml0aWFsIHN0YXRlLiBZb3UgbWF5IG9wdGlvbmFsbHkgc3BlY2lmeSBpdFxuICogdG8gaHlkcmF0ZSB0aGUgc3RhdGUgZnJvbSB0aGUgc2VydmVyIGluIHVuaXZlcnNhbCBhcHBzLCBvciB0byByZXN0b3JlIGFcbiAqIHByZXZpb3VzbHkgc2VyaWFsaXplZCB1c2VyIHNlc3Npb24uXG4gKiBJZiB5b3UgdXNlIGBjb21iaW5lUmVkdWNlcnNgIHRvIHByb2R1Y2UgdGhlIHJvb3QgcmVkdWNlciBmdW5jdGlvbiwgdGhpcyBtdXN0IGJlXG4gKiBhbiBvYmplY3Qgd2l0aCB0aGUgc2FtZSBzaGFwZSBhcyBgY29tYmluZVJlZHVjZXJzYCBrZXlzLlxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IFtlbmhhbmNlcl0gVGhlIHN0b3JlIGVuaGFuY2VyLiBZb3UgbWF5IG9wdGlvbmFsbHkgc3BlY2lmeSBpdFxuICogdG8gZW5oYW5jZSB0aGUgc3RvcmUgd2l0aCB0aGlyZC1wYXJ0eSBjYXBhYmlsaXRpZXMgc3VjaCBhcyBtaWRkbGV3YXJlLFxuICogdGltZSB0cmF2ZWwsIHBlcnNpc3RlbmNlLCBldGMuIFRoZSBvbmx5IHN0b3JlIGVuaGFuY2VyIHRoYXQgc2hpcHMgd2l0aCBSZWR1eFxuICogaXMgYGFwcGx5TWlkZGxld2FyZSgpYC5cbiAqXG4gKiBAcmV0dXJucyB7U3RvcmV9IEEgUmVkdXggc3RvcmUgdGhhdCBsZXRzIHlvdSByZWFkIHRoZSBzdGF0ZSwgZGlzcGF0Y2ggYWN0aW9uc1xuICogYW5kIHN1YnNjcmliZSB0byBjaGFuZ2VzLlxuICovXG5cbmZ1bmN0aW9uIGNyZWF0ZVN0b3JlKHJlZHVjZXIsIHByZWxvYWRlZFN0YXRlLCBlbmhhbmNlcikge1xuICB2YXIgX3JlZjI7XG5cbiAgaWYgKHR5cGVvZiBwcmVsb2FkZWRTdGF0ZSA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgZW5oYW5jZXIgPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIGVuaGFuY2VyID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBhcmd1bWVudHNbM10gPT09ICdmdW5jdGlvbicpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0l0IGxvb2tzIGxpa2UgeW91IGFyZSBwYXNzaW5nIHNldmVyYWwgc3RvcmUgZW5oYW5jZXJzIHRvICcgKyAnY3JlYXRlU3RvcmUoKS4gVGhpcyBpcyBub3Qgc3VwcG9ydGVkLiBJbnN0ZWFkLCBjb21wb3NlIHRoZW0gJyArICd0b2dldGhlciB0byBhIHNpbmdsZSBmdW5jdGlvbi4nKTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgcHJlbG9hZGVkU3RhdGUgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGVuaGFuY2VyID09PSAndW5kZWZpbmVkJykge1xuICAgIGVuaGFuY2VyID0gcHJlbG9hZGVkU3RhdGU7XG4gICAgcHJlbG9hZGVkU3RhdGUgPSB1bmRlZmluZWQ7XG4gIH1cblxuICBpZiAodHlwZW9mIGVuaGFuY2VyICE9PSAndW5kZWZpbmVkJykge1xuICAgIGlmICh0eXBlb2YgZW5oYW5jZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgdGhlIGVuaGFuY2VyIHRvIGJlIGEgZnVuY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVuaGFuY2VyKGNyZWF0ZVN0b3JlKShyZWR1Y2VyLCBwcmVsb2FkZWRTdGF0ZSk7XG4gIH1cblxuICBpZiAodHlwZW9mIHJlZHVjZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIHRoZSByZWR1Y2VyIHRvIGJlIGEgZnVuY3Rpb24uJyk7XG4gIH1cblxuICB2YXIgY3VycmVudFJlZHVjZXIgPSByZWR1Y2VyO1xuICB2YXIgY3VycmVudFN0YXRlID0gcHJlbG9hZGVkU3RhdGU7XG4gIHZhciBjdXJyZW50TGlzdGVuZXJzID0gW107XG4gIHZhciBuZXh0TGlzdGVuZXJzID0gY3VycmVudExpc3RlbmVycztcbiAgdmFyIGlzRGlzcGF0Y2hpbmcgPSBmYWxzZTtcbiAgLyoqXG4gICAqIFRoaXMgbWFrZXMgYSBzaGFsbG93IGNvcHkgb2YgY3VycmVudExpc3RlbmVycyBzbyB3ZSBjYW4gdXNlXG4gICAqIG5leHRMaXN0ZW5lcnMgYXMgYSB0ZW1wb3JhcnkgbGlzdCB3aGlsZSBkaXNwYXRjaGluZy5cbiAgICpcbiAgICogVGhpcyBwcmV2ZW50cyBhbnkgYnVncyBhcm91bmQgY29uc3VtZXJzIGNhbGxpbmdcbiAgICogc3Vic2NyaWJlL3Vuc3Vic2NyaWJlIGluIHRoZSBtaWRkbGUgb2YgYSBkaXNwYXRjaC5cbiAgICovXG5cbiAgZnVuY3Rpb24gZW5zdXJlQ2FuTXV0YXRlTmV4dExpc3RlbmVycygpIHtcbiAgICBpZiAobmV4dExpc3RlbmVycyA9PT0gY3VycmVudExpc3RlbmVycykge1xuICAgICAgbmV4dExpc3RlbmVycyA9IGN1cnJlbnRMaXN0ZW5lcnMuc2xpY2UoKTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIFJlYWRzIHRoZSBzdGF0ZSB0cmVlIG1hbmFnZWQgYnkgdGhlIHN0b3JlLlxuICAgKlxuICAgKiBAcmV0dXJucyB7YW55fSBUaGUgY3VycmVudCBzdGF0ZSB0cmVlIG9mIHlvdXIgYXBwbGljYXRpb24uXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gZ2V0U3RhdGUoKSB7XG4gICAgaWYgKGlzRGlzcGF0Y2hpbmcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG1heSBub3QgY2FsbCBzdG9yZS5nZXRTdGF0ZSgpIHdoaWxlIHRoZSByZWR1Y2VyIGlzIGV4ZWN1dGluZy4gJyArICdUaGUgcmVkdWNlciBoYXMgYWxyZWFkeSByZWNlaXZlZCB0aGUgc3RhdGUgYXMgYW4gYXJndW1lbnQuICcgKyAnUGFzcyBpdCBkb3duIGZyb20gdGhlIHRvcCByZWR1Y2VyIGluc3RlYWQgb2YgcmVhZGluZyBpdCBmcm9tIHRoZSBzdG9yZS4nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY3VycmVudFN0YXRlO1xuICB9XG4gIC8qKlxuICAgKiBBZGRzIGEgY2hhbmdlIGxpc3RlbmVyLiBJdCB3aWxsIGJlIGNhbGxlZCBhbnkgdGltZSBhbiBhY3Rpb24gaXMgZGlzcGF0Y2hlZCxcbiAgICogYW5kIHNvbWUgcGFydCBvZiB0aGUgc3RhdGUgdHJlZSBtYXkgcG90ZW50aWFsbHkgaGF2ZSBjaGFuZ2VkLiBZb3UgbWF5IHRoZW5cbiAgICogY2FsbCBgZ2V0U3RhdGUoKWAgdG8gcmVhZCB0aGUgY3VycmVudCBzdGF0ZSB0cmVlIGluc2lkZSB0aGUgY2FsbGJhY2suXG4gICAqXG4gICAqIFlvdSBtYXkgY2FsbCBgZGlzcGF0Y2goKWAgZnJvbSBhIGNoYW5nZSBsaXN0ZW5lciwgd2l0aCB0aGUgZm9sbG93aW5nXG4gICAqIGNhdmVhdHM6XG4gICAqXG4gICAqIDEuIFRoZSBzdWJzY3JpcHRpb25zIGFyZSBzbmFwc2hvdHRlZCBqdXN0IGJlZm9yZSBldmVyeSBgZGlzcGF0Y2goKWAgY2FsbC5cbiAgICogSWYgeW91IHN1YnNjcmliZSBvciB1bnN1YnNjcmliZSB3aGlsZSB0aGUgbGlzdGVuZXJzIGFyZSBiZWluZyBpbnZva2VkLCB0aGlzXG4gICAqIHdpbGwgbm90IGhhdmUgYW55IGVmZmVjdCBvbiB0aGUgYGRpc3BhdGNoKClgIHRoYXQgaXMgY3VycmVudGx5IGluIHByb2dyZXNzLlxuICAgKiBIb3dldmVyLCB0aGUgbmV4dCBgZGlzcGF0Y2goKWAgY2FsbCwgd2hldGhlciBuZXN0ZWQgb3Igbm90LCB3aWxsIHVzZSBhIG1vcmVcbiAgICogcmVjZW50IHNuYXBzaG90IG9mIHRoZSBzdWJzY3JpcHRpb24gbGlzdC5cbiAgICpcbiAgICogMi4gVGhlIGxpc3RlbmVyIHNob3VsZCBub3QgZXhwZWN0IHRvIHNlZSBhbGwgc3RhdGUgY2hhbmdlcywgYXMgdGhlIHN0YXRlXG4gICAqIG1pZ2h0IGhhdmUgYmVlbiB1cGRhdGVkIG11bHRpcGxlIHRpbWVzIGR1cmluZyBhIG5lc3RlZCBgZGlzcGF0Y2goKWAgYmVmb3JlXG4gICAqIHRoZSBsaXN0ZW5lciBpcyBjYWxsZWQuIEl0IGlzLCBob3dldmVyLCBndWFyYW50ZWVkIHRoYXQgYWxsIHN1YnNjcmliZXJzXG4gICAqIHJlZ2lzdGVyZWQgYmVmb3JlIHRoZSBgZGlzcGF0Y2goKWAgc3RhcnRlZCB3aWxsIGJlIGNhbGxlZCB3aXRoIHRoZSBsYXRlc3RcbiAgICogc3RhdGUgYnkgdGhlIHRpbWUgaXQgZXhpdHMuXG4gICAqXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIEEgY2FsbGJhY2sgdG8gYmUgaW52b2tlZCBvbiBldmVyeSBkaXNwYXRjaC5cbiAgICogQHJldHVybnMge0Z1bmN0aW9ufSBBIGZ1bmN0aW9uIHRvIHJlbW92ZSB0aGlzIGNoYW5nZSBsaXN0ZW5lci5cbiAgICovXG5cblxuICBmdW5jdGlvbiBzdWJzY3JpYmUobGlzdGVuZXIpIHtcbiAgICBpZiAodHlwZW9mIGxpc3RlbmVyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIHRoZSBsaXN0ZW5lciB0byBiZSBhIGZ1bmN0aW9uLicpO1xuICAgIH1cblxuICAgIGlmIChpc0Rpc3BhdGNoaW5nKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtYXkgbm90IGNhbGwgc3RvcmUuc3Vic2NyaWJlKCkgd2hpbGUgdGhlIHJlZHVjZXIgaXMgZXhlY3V0aW5nLiAnICsgJ0lmIHlvdSB3b3VsZCBsaWtlIHRvIGJlIG5vdGlmaWVkIGFmdGVyIHRoZSBzdG9yZSBoYXMgYmVlbiB1cGRhdGVkLCBzdWJzY3JpYmUgZnJvbSBhICcgKyAnY29tcG9uZW50IGFuZCBpbnZva2Ugc3RvcmUuZ2V0U3RhdGUoKSBpbiB0aGUgY2FsbGJhY2sgdG8gYWNjZXNzIHRoZSBsYXRlc3Qgc3RhdGUuICcgKyAnU2VlIGh0dHBzOi8vcmVkdXguanMub3JnL2FwaS1yZWZlcmVuY2Uvc3RvcmUjc3Vic2NyaWJlbGlzdGVuZXIgZm9yIG1vcmUgZGV0YWlscy4nKTtcbiAgICB9XG5cbiAgICB2YXIgaXNTdWJzY3JpYmVkID0gdHJ1ZTtcbiAgICBlbnN1cmVDYW5NdXRhdGVOZXh0TGlzdGVuZXJzKCk7XG4gICAgbmV4dExpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7XG4gICAgICBpZiAoIWlzU3Vic2NyaWJlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChpc0Rpc3BhdGNoaW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG1heSBub3QgdW5zdWJzY3JpYmUgZnJvbSBhIHN0b3JlIGxpc3RlbmVyIHdoaWxlIHRoZSByZWR1Y2VyIGlzIGV4ZWN1dGluZy4gJyArICdTZWUgaHR0cHM6Ly9yZWR1eC5qcy5vcmcvYXBpLXJlZmVyZW5jZS9zdG9yZSNzdWJzY3JpYmVsaXN0ZW5lciBmb3IgbW9yZSBkZXRhaWxzLicpO1xuICAgICAgfVxuXG4gICAgICBpc1N1YnNjcmliZWQgPSBmYWxzZTtcbiAgICAgIGVuc3VyZUNhbk11dGF0ZU5leHRMaXN0ZW5lcnMoKTtcbiAgICAgIHZhciBpbmRleCA9IG5leHRMaXN0ZW5lcnMuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgICBuZXh0TGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICBjdXJyZW50TGlzdGVuZXJzID0gbnVsbDtcbiAgICB9O1xuICB9XG4gIC8qKlxuICAgKiBEaXNwYXRjaGVzIGFuIGFjdGlvbi4gSXQgaXMgdGhlIG9ubHkgd2F5IHRvIHRyaWdnZXIgYSBzdGF0ZSBjaGFuZ2UuXG4gICAqXG4gICAqIFRoZSBgcmVkdWNlcmAgZnVuY3Rpb24sIHVzZWQgdG8gY3JlYXRlIHRoZSBzdG9yZSwgd2lsbCBiZSBjYWxsZWQgd2l0aCB0aGVcbiAgICogY3VycmVudCBzdGF0ZSB0cmVlIGFuZCB0aGUgZ2l2ZW4gYGFjdGlvbmAuIEl0cyByZXR1cm4gdmFsdWUgd2lsbFxuICAgKiBiZSBjb25zaWRlcmVkIHRoZSAqKm5leHQqKiBzdGF0ZSBvZiB0aGUgdHJlZSwgYW5kIHRoZSBjaGFuZ2UgbGlzdGVuZXJzXG4gICAqIHdpbGwgYmUgbm90aWZpZWQuXG4gICAqXG4gICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9ubHkgc3VwcG9ydHMgcGxhaW4gb2JqZWN0IGFjdGlvbnMuIElmIHlvdSB3YW50IHRvXG4gICAqIGRpc3BhdGNoIGEgUHJvbWlzZSwgYW4gT2JzZXJ2YWJsZSwgYSB0aHVuaywgb3Igc29tZXRoaW5nIGVsc2UsIHlvdSBuZWVkIHRvXG4gICAqIHdyYXAgeW91ciBzdG9yZSBjcmVhdGluZyBmdW5jdGlvbiBpbnRvIHRoZSBjb3JyZXNwb25kaW5nIG1pZGRsZXdhcmUuIEZvclxuICAgKiBleGFtcGxlLCBzZWUgdGhlIGRvY3VtZW50YXRpb24gZm9yIHRoZSBgcmVkdXgtdGh1bmtgIHBhY2thZ2UuIEV2ZW4gdGhlXG4gICAqIG1pZGRsZXdhcmUgd2lsbCBldmVudHVhbGx5IGRpc3BhdGNoIHBsYWluIG9iamVjdCBhY3Rpb25zIHVzaW5nIHRoaXMgbWV0aG9kLlxuICAgKlxuICAgKiBAcGFyYW0ge09iamVjdH0gYWN0aW9uIEEgcGxhaW4gb2JqZWN0IHJlcHJlc2VudGluZyDigJx3aGF0IGNoYW5nZWTigJ0uIEl0IGlzXG4gICAqIGEgZ29vZCBpZGVhIHRvIGtlZXAgYWN0aW9ucyBzZXJpYWxpemFibGUgc28geW91IGNhbiByZWNvcmQgYW5kIHJlcGxheSB1c2VyXG4gICAqIHNlc3Npb25zLCBvciB1c2UgdGhlIHRpbWUgdHJhdmVsbGluZyBgcmVkdXgtZGV2dG9vbHNgLiBBbiBhY3Rpb24gbXVzdCBoYXZlXG4gICAqIGEgYHR5cGVgIHByb3BlcnR5IHdoaWNoIG1heSBub3QgYmUgYHVuZGVmaW5lZGAuIEl0IGlzIGEgZ29vZCBpZGVhIHRvIHVzZVxuICAgKiBzdHJpbmcgY29uc3RhbnRzIGZvciBhY3Rpb24gdHlwZXMuXG4gICAqXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IEZvciBjb252ZW5pZW5jZSwgdGhlIHNhbWUgYWN0aW9uIG9iamVjdCB5b3UgZGlzcGF0Y2hlZC5cbiAgICpcbiAgICogTm90ZSB0aGF0LCBpZiB5b3UgdXNlIGEgY3VzdG9tIG1pZGRsZXdhcmUsIGl0IG1heSB3cmFwIGBkaXNwYXRjaCgpYCB0b1xuICAgKiByZXR1cm4gc29tZXRoaW5nIGVsc2UgKGZvciBleGFtcGxlLCBhIFByb21pc2UgeW91IGNhbiBhd2FpdCkuXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gZGlzcGF0Y2goYWN0aW9uKSB7XG4gICAgaWYgKCFpc1BsYWluT2JqZWN0KGFjdGlvbikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQWN0aW9ucyBtdXN0IGJlIHBsYWluIG9iamVjdHMuICcgKyAnVXNlIGN1c3RvbSBtaWRkbGV3YXJlIGZvciBhc3luYyBhY3Rpb25zLicpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgYWN0aW9uLnR5cGUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FjdGlvbnMgbWF5IG5vdCBoYXZlIGFuIHVuZGVmaW5lZCBcInR5cGVcIiBwcm9wZXJ0eS4gJyArICdIYXZlIHlvdSBtaXNzcGVsbGVkIGEgY29uc3RhbnQ/Jyk7XG4gICAgfVxuXG4gICAgaWYgKGlzRGlzcGF0Y2hpbmcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVkdWNlcnMgbWF5IG5vdCBkaXNwYXRjaCBhY3Rpb25zLicpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBpc0Rpc3BhdGNoaW5nID0gdHJ1ZTtcbiAgICAgIGN1cnJlbnRTdGF0ZSA9IGN1cnJlbnRSZWR1Y2VyKGN1cnJlbnRTdGF0ZSwgYWN0aW9uKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgaXNEaXNwYXRjaGluZyA9IGZhbHNlO1xuICAgIH1cblxuICAgIHZhciBsaXN0ZW5lcnMgPSBjdXJyZW50TGlzdGVuZXJzID0gbmV4dExpc3RlbmVycztcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgbGlzdGVuZXIgPSBsaXN0ZW5lcnNbaV07XG4gICAgICBsaXN0ZW5lcigpO1xuICAgIH1cblxuICAgIHJldHVybiBhY3Rpb247XG4gIH1cbiAgLyoqXG4gICAqIFJlcGxhY2VzIHRoZSByZWR1Y2VyIGN1cnJlbnRseSB1c2VkIGJ5IHRoZSBzdG9yZSB0byBjYWxjdWxhdGUgdGhlIHN0YXRlLlxuICAgKlxuICAgKiBZb3UgbWlnaHQgbmVlZCB0aGlzIGlmIHlvdXIgYXBwIGltcGxlbWVudHMgY29kZSBzcGxpdHRpbmcgYW5kIHlvdSB3YW50IHRvXG4gICAqIGxvYWQgc29tZSBvZiB0aGUgcmVkdWNlcnMgZHluYW1pY2FsbHkuIFlvdSBtaWdodCBhbHNvIG5lZWQgdGhpcyBpZiB5b3VcbiAgICogaW1wbGVtZW50IGEgaG90IHJlbG9hZGluZyBtZWNoYW5pc20gZm9yIFJlZHV4LlxuICAgKlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBuZXh0UmVkdWNlciBUaGUgcmVkdWNlciBmb3IgdGhlIHN0b3JlIHRvIHVzZSBpbnN0ZWFkLlxuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG5cblxuICBmdW5jdGlvbiByZXBsYWNlUmVkdWNlcihuZXh0UmVkdWNlcikge1xuICAgIGlmICh0eXBlb2YgbmV4dFJlZHVjZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgdGhlIG5leHRSZWR1Y2VyIHRvIGJlIGEgZnVuY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgY3VycmVudFJlZHVjZXIgPSBuZXh0UmVkdWNlcjsgLy8gVGhpcyBhY3Rpb24gaGFzIGEgc2ltaWxpYXIgZWZmZWN0IHRvIEFjdGlvblR5cGVzLklOSVQuXG4gICAgLy8gQW55IHJlZHVjZXJzIHRoYXQgZXhpc3RlZCBpbiBib3RoIHRoZSBuZXcgYW5kIG9sZCByb290UmVkdWNlclxuICAgIC8vIHdpbGwgcmVjZWl2ZSB0aGUgcHJldmlvdXMgc3RhdGUuIFRoaXMgZWZmZWN0aXZlbHkgcG9wdWxhdGVzXG4gICAgLy8gdGhlIG5ldyBzdGF0ZSB0cmVlIHdpdGggYW55IHJlbGV2YW50IGRhdGEgZnJvbSB0aGUgb2xkIG9uZS5cblxuICAgIGRpc3BhdGNoKHtcbiAgICAgIHR5cGU6IEFjdGlvblR5cGVzLlJFUExBQ0VcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogSW50ZXJvcGVyYWJpbGl0eSBwb2ludCBmb3Igb2JzZXJ2YWJsZS9yZWFjdGl2ZSBsaWJyYXJpZXMuXG4gICAqIEByZXR1cm5zIHtvYnNlcnZhYmxlfSBBIG1pbmltYWwgb2JzZXJ2YWJsZSBvZiBzdGF0ZSBjaGFuZ2VzLlxuICAgKiBGb3IgbW9yZSBpbmZvcm1hdGlvbiwgc2VlIHRoZSBvYnNlcnZhYmxlIHByb3Bvc2FsOlxuICAgKiBodHRwczovL2dpdGh1Yi5jb20vdGMzOS9wcm9wb3NhbC1vYnNlcnZhYmxlXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gb2JzZXJ2YWJsZSgpIHtcbiAgICB2YXIgX3JlZjtcblxuICAgIHZhciBvdXRlclN1YnNjcmliZSA9IHN1YnNjcmliZTtcbiAgICByZXR1cm4gX3JlZiA9IHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIG1pbmltYWwgb2JzZXJ2YWJsZSBzdWJzY3JpcHRpb24gbWV0aG9kLlxuICAgICAgICogQHBhcmFtIHtPYmplY3R9IG9ic2VydmVyIEFueSBvYmplY3QgdGhhdCBjYW4gYmUgdXNlZCBhcyBhbiBvYnNlcnZlci5cbiAgICAgICAqIFRoZSBvYnNlcnZlciBvYmplY3Qgc2hvdWxkIGhhdmUgYSBgbmV4dGAgbWV0aG9kLlxuICAgICAgICogQHJldHVybnMge3N1YnNjcmlwdGlvbn0gQW4gb2JqZWN0IHdpdGggYW4gYHVuc3Vic2NyaWJlYCBtZXRob2QgdGhhdCBjYW5cbiAgICAgICAqIGJlIHVzZWQgdG8gdW5zdWJzY3JpYmUgdGhlIG9ic2VydmFibGUgZnJvbSB0aGUgc3RvcmUsIGFuZCBwcmV2ZW50IGZ1cnRoZXJcbiAgICAgICAqIGVtaXNzaW9uIG9mIHZhbHVlcyBmcm9tIHRoZSBvYnNlcnZhYmxlLlxuICAgICAgICovXG4gICAgICBzdWJzY3JpYmU6IGZ1bmN0aW9uIHN1YnNjcmliZShvYnNlcnZlcikge1xuICAgICAgICBpZiAodHlwZW9mIG9ic2VydmVyICE9PSAnb2JqZWN0JyB8fCBvYnNlcnZlciA9PT0gbnVsbCkge1xuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIHRoZSBvYnNlcnZlciB0byBiZSBhbiBvYmplY3QuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBvYnNlcnZlU3RhdGUoKSB7XG4gICAgICAgICAgaWYgKG9ic2VydmVyLm5leHQpIHtcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQoZ2V0U3RhdGUoKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgb2JzZXJ2ZVN0YXRlKCk7XG4gICAgICAgIHZhciB1bnN1YnNjcmliZSA9IG91dGVyU3Vic2NyaWJlKG9ic2VydmVTdGF0ZSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdW5zdWJzY3JpYmU6IHVuc3Vic2NyaWJlXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSwgX3JlZlskJG9ic2VydmFibGVdID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgX3JlZjtcbiAgfSAvLyBXaGVuIGEgc3RvcmUgaXMgY3JlYXRlZCwgYW4gXCJJTklUXCIgYWN0aW9uIGlzIGRpc3BhdGNoZWQgc28gdGhhdCBldmVyeVxuICAvLyByZWR1Y2VyIHJldHVybnMgdGhlaXIgaW5pdGlhbCBzdGF0ZS4gVGhpcyBlZmZlY3RpdmVseSBwb3B1bGF0ZXNcbiAgLy8gdGhlIGluaXRpYWwgc3RhdGUgdHJlZS5cblxuXG4gIGRpc3BhdGNoKHtcbiAgICB0eXBlOiBBY3Rpb25UeXBlcy5JTklUXG4gIH0pO1xuICByZXR1cm4gX3JlZjIgPSB7XG4gICAgZGlzcGF0Y2g6IGRpc3BhdGNoLFxuICAgIHN1YnNjcmliZTogc3Vic2NyaWJlLFxuICAgIGdldFN0YXRlOiBnZXRTdGF0ZSxcbiAgICByZXBsYWNlUmVkdWNlcjogcmVwbGFjZVJlZHVjZXJcbiAgfSwgX3JlZjJbJCRvYnNlcnZhYmxlXSA9IG9ic2VydmFibGUsIF9yZWYyO1xufVxuXG4vKipcbiAqIFByaW50cyBhIHdhcm5pbmcgaW4gdGhlIGNvbnNvbGUgaWYgaXQgZXhpc3RzLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlIFRoZSB3YXJuaW5nIG1lc3NhZ2UuXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqL1xuZnVuY3Rpb24gd2FybmluZyhtZXNzYWdlKSB7XG4gIC8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUgKi9cbiAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5lcnJvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSk7XG4gIH1cbiAgLyogZXNsaW50LWVuYWJsZSBuby1jb25zb2xlICovXG5cblxuICB0cnkge1xuICAgIC8vIFRoaXMgZXJyb3Igd2FzIHRocm93biBhcyBhIGNvbnZlbmllbmNlIHNvIHRoYXQgaWYgeW91IGVuYWJsZVxuICAgIC8vIFwiYnJlYWsgb24gYWxsIGV4Y2VwdGlvbnNcIiBpbiB5b3VyIGNvbnNvbGUsXG4gICAgLy8gaXQgd291bGQgcGF1c2UgdGhlIGV4ZWN1dGlvbiBhdCB0aGlzIGxpbmUuXG4gICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xuICB9IGNhdGNoIChlKSB7fSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWVtcHR5XG5cbn1cblxuZnVuY3Rpb24gZ2V0VW5kZWZpbmVkU3RhdGVFcnJvck1lc3NhZ2Uoa2V5LCBhY3Rpb24pIHtcbiAgdmFyIGFjdGlvblR5cGUgPSBhY3Rpb24gJiYgYWN0aW9uLnR5cGU7XG4gIHZhciBhY3Rpb25EZXNjcmlwdGlvbiA9IGFjdGlvblR5cGUgJiYgXCJhY3Rpb24gXFxcIlwiICsgU3RyaW5nKGFjdGlvblR5cGUpICsgXCJcXFwiXCIgfHwgJ2FuIGFjdGlvbic7XG4gIHJldHVybiBcIkdpdmVuIFwiICsgYWN0aW9uRGVzY3JpcHRpb24gKyBcIiwgcmVkdWNlciBcXFwiXCIgKyBrZXkgKyBcIlxcXCIgcmV0dXJuZWQgdW5kZWZpbmVkLiBcIiArIFwiVG8gaWdub3JlIGFuIGFjdGlvbiwgeW91IG11c3QgZXhwbGljaXRseSByZXR1cm4gdGhlIHByZXZpb3VzIHN0YXRlLiBcIiArIFwiSWYgeW91IHdhbnQgdGhpcyByZWR1Y2VyIHRvIGhvbGQgbm8gdmFsdWUsIHlvdSBjYW4gcmV0dXJuIG51bGwgaW5zdGVhZCBvZiB1bmRlZmluZWQuXCI7XG59XG5cbmZ1bmN0aW9uIGdldFVuZXhwZWN0ZWRTdGF0ZVNoYXBlV2FybmluZ01lc3NhZ2UoaW5wdXRTdGF0ZSwgcmVkdWNlcnMsIGFjdGlvbiwgdW5leHBlY3RlZEtleUNhY2hlKSB7XG4gIHZhciByZWR1Y2VyS2V5cyA9IE9iamVjdC5rZXlzKHJlZHVjZXJzKTtcbiAgdmFyIGFyZ3VtZW50TmFtZSA9IGFjdGlvbiAmJiBhY3Rpb24udHlwZSA9PT0gQWN0aW9uVHlwZXMuSU5JVCA/ICdwcmVsb2FkZWRTdGF0ZSBhcmd1bWVudCBwYXNzZWQgdG8gY3JlYXRlU3RvcmUnIDogJ3ByZXZpb3VzIHN0YXRlIHJlY2VpdmVkIGJ5IHRoZSByZWR1Y2VyJztcblxuICBpZiAocmVkdWNlcktleXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuICdTdG9yZSBkb2VzIG5vdCBoYXZlIGEgdmFsaWQgcmVkdWNlci4gTWFrZSBzdXJlIHRoZSBhcmd1bWVudCBwYXNzZWQgJyArICd0byBjb21iaW5lUmVkdWNlcnMgaXMgYW4gb2JqZWN0IHdob3NlIHZhbHVlcyBhcmUgcmVkdWNlcnMuJztcbiAgfVxuXG4gIGlmICghaXNQbGFpbk9iamVjdChpbnB1dFN0YXRlKSkge1xuICAgIHJldHVybiBcIlRoZSBcIiArIGFyZ3VtZW50TmFtZSArIFwiIGhhcyB1bmV4cGVjdGVkIHR5cGUgb2YgXFxcIlwiICsge30udG9TdHJpbmcuY2FsbChpbnB1dFN0YXRlKS5tYXRjaCgvXFxzKFthLXp8QS1aXSspLylbMV0gKyBcIlxcXCIuIEV4cGVjdGVkIGFyZ3VtZW50IHRvIGJlIGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgXCIgKyAoXCJrZXlzOiBcXFwiXCIgKyByZWR1Y2VyS2V5cy5qb2luKCdcIiwgXCInKSArIFwiXFxcIlwiKTtcbiAgfVxuXG4gIHZhciB1bmV4cGVjdGVkS2V5cyA9IE9iamVjdC5rZXlzKGlucHV0U3RhdGUpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7XG4gICAgcmV0dXJuICFyZWR1Y2Vycy5oYXNPd25Qcm9wZXJ0eShrZXkpICYmICF1bmV4cGVjdGVkS2V5Q2FjaGVba2V5XTtcbiAgfSk7XG4gIHVuZXhwZWN0ZWRLZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIHVuZXhwZWN0ZWRLZXlDYWNoZVtrZXldID0gdHJ1ZTtcbiAgfSk7XG4gIGlmIChhY3Rpb24gJiYgYWN0aW9uLnR5cGUgPT09IEFjdGlvblR5cGVzLlJFUExBQ0UpIHJldHVybjtcblxuICBpZiAodW5leHBlY3RlZEtleXMubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiBcIlVuZXhwZWN0ZWQgXCIgKyAodW5leHBlY3RlZEtleXMubGVuZ3RoID4gMSA/ICdrZXlzJyA6ICdrZXknKSArIFwiIFwiICsgKFwiXFxcIlwiICsgdW5leHBlY3RlZEtleXMuam9pbignXCIsIFwiJykgKyBcIlxcXCIgZm91bmQgaW4gXCIgKyBhcmd1bWVudE5hbWUgKyBcIi4gXCIpICsgXCJFeHBlY3RlZCB0byBmaW5kIG9uZSBvZiB0aGUga25vd24gcmVkdWNlciBrZXlzIGluc3RlYWQ6IFwiICsgKFwiXFxcIlwiICsgcmVkdWNlcktleXMuam9pbignXCIsIFwiJykgKyBcIlxcXCIuIFVuZXhwZWN0ZWQga2V5cyB3aWxsIGJlIGlnbm9yZWQuXCIpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFJlZHVjZXJTaGFwZShyZWR1Y2Vycykge1xuICBPYmplY3Qua2V5cyhyZWR1Y2VycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgdmFyIHJlZHVjZXIgPSByZWR1Y2Vyc1trZXldO1xuICAgIHZhciBpbml0aWFsU3RhdGUgPSByZWR1Y2VyKHVuZGVmaW5lZCwge1xuICAgICAgdHlwZTogQWN0aW9uVHlwZXMuSU5JVFxuICAgIH0pO1xuXG4gICAgaWYgKHR5cGVvZiBpbml0aWFsU3RhdGUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSZWR1Y2VyIFxcXCJcIiArIGtleSArIFwiXFxcIiByZXR1cm5lZCB1bmRlZmluZWQgZHVyaW5nIGluaXRpYWxpemF0aW9uLiBcIiArIFwiSWYgdGhlIHN0YXRlIHBhc3NlZCB0byB0aGUgcmVkdWNlciBpcyB1bmRlZmluZWQsIHlvdSBtdXN0IFwiICsgXCJleHBsaWNpdGx5IHJldHVybiB0aGUgaW5pdGlhbCBzdGF0ZS4gVGhlIGluaXRpYWwgc3RhdGUgbWF5IFwiICsgXCJub3QgYmUgdW5kZWZpbmVkLiBJZiB5b3UgZG9uJ3Qgd2FudCB0byBzZXQgYSB2YWx1ZSBmb3IgdGhpcyByZWR1Y2VyLCBcIiArIFwieW91IGNhbiB1c2UgbnVsbCBpbnN0ZWFkIG9mIHVuZGVmaW5lZC5cIik7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiByZWR1Y2VyKHVuZGVmaW5lZCwge1xuICAgICAgdHlwZTogQWN0aW9uVHlwZXMuUFJPQkVfVU5LTk9XTl9BQ1RJT04oKVxuICAgIH0pID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUmVkdWNlciBcXFwiXCIgKyBrZXkgKyBcIlxcXCIgcmV0dXJuZWQgdW5kZWZpbmVkIHdoZW4gcHJvYmVkIHdpdGggYSByYW5kb20gdHlwZS4gXCIgKyAoXCJEb24ndCB0cnkgdG8gaGFuZGxlIFwiICsgQWN0aW9uVHlwZXMuSU5JVCArIFwiIG9yIG90aGVyIGFjdGlvbnMgaW4gXFxcInJlZHV4LypcXFwiIFwiKSArIFwibmFtZXNwYWNlLiBUaGV5IGFyZSBjb25zaWRlcmVkIHByaXZhdGUuIEluc3RlYWQsIHlvdSBtdXN0IHJldHVybiB0aGUgXCIgKyBcImN1cnJlbnQgc3RhdGUgZm9yIGFueSB1bmtub3duIGFjdGlvbnMsIHVubGVzcyBpdCBpcyB1bmRlZmluZWQsIFwiICsgXCJpbiB3aGljaCBjYXNlIHlvdSBtdXN0IHJldHVybiB0aGUgaW5pdGlhbCBzdGF0ZSwgcmVnYXJkbGVzcyBvZiB0aGUgXCIgKyBcImFjdGlvbiB0eXBlLiBUaGUgaW5pdGlhbCBzdGF0ZSBtYXkgbm90IGJlIHVuZGVmaW5lZCwgYnV0IGNhbiBiZSBudWxsLlwiKTtcbiAgICB9XG4gIH0pO1xufVxuLyoqXG4gKiBUdXJucyBhbiBvYmplY3Qgd2hvc2UgdmFsdWVzIGFyZSBkaWZmZXJlbnQgcmVkdWNlciBmdW5jdGlvbnMsIGludG8gYSBzaW5nbGVcbiAqIHJlZHVjZXIgZnVuY3Rpb24uIEl0IHdpbGwgY2FsbCBldmVyeSBjaGlsZCByZWR1Y2VyLCBhbmQgZ2F0aGVyIHRoZWlyIHJlc3VsdHNcbiAqIGludG8gYSBzaW5nbGUgc3RhdGUgb2JqZWN0LCB3aG9zZSBrZXlzIGNvcnJlc3BvbmQgdG8gdGhlIGtleXMgb2YgdGhlIHBhc3NlZFxuICogcmVkdWNlciBmdW5jdGlvbnMuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHJlZHVjZXJzIEFuIG9iamVjdCB3aG9zZSB2YWx1ZXMgY29ycmVzcG9uZCB0byBkaWZmZXJlbnRcbiAqIHJlZHVjZXIgZnVuY3Rpb25zIHRoYXQgbmVlZCB0byBiZSBjb21iaW5lZCBpbnRvIG9uZS4gT25lIGhhbmR5IHdheSB0byBvYnRhaW5cbiAqIGl0IGlzIHRvIHVzZSBFUzYgYGltcG9ydCAqIGFzIHJlZHVjZXJzYCBzeW50YXguIFRoZSByZWR1Y2VycyBtYXkgbmV2ZXIgcmV0dXJuXG4gKiB1bmRlZmluZWQgZm9yIGFueSBhY3Rpb24uIEluc3RlYWQsIHRoZXkgc2hvdWxkIHJldHVybiB0aGVpciBpbml0aWFsIHN0YXRlXG4gKiBpZiB0aGUgc3RhdGUgcGFzc2VkIHRvIHRoZW0gd2FzIHVuZGVmaW5lZCwgYW5kIHRoZSBjdXJyZW50IHN0YXRlIGZvciBhbnlcbiAqIHVucmVjb2duaXplZCBhY3Rpb24uXG4gKlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBBIHJlZHVjZXIgZnVuY3Rpb24gdGhhdCBpbnZva2VzIGV2ZXJ5IHJlZHVjZXIgaW5zaWRlIHRoZVxuICogcGFzc2VkIG9iamVjdCwgYW5kIGJ1aWxkcyBhIHN0YXRlIG9iamVjdCB3aXRoIHRoZSBzYW1lIHNoYXBlLlxuICovXG5cblxuZnVuY3Rpb24gY29tYmluZVJlZHVjZXJzKHJlZHVjZXJzKSB7XG4gIHZhciByZWR1Y2VyS2V5cyA9IE9iamVjdC5rZXlzKHJlZHVjZXJzKTtcbiAgdmFyIGZpbmFsUmVkdWNlcnMgPSB7fTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHJlZHVjZXJLZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGtleSA9IHJlZHVjZXJLZXlzW2ldO1xuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGlmICh0eXBlb2YgcmVkdWNlcnNba2V5XSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2FybmluZyhcIk5vIHJlZHVjZXIgcHJvdmlkZWQgZm9yIGtleSBcXFwiXCIgKyBrZXkgKyBcIlxcXCJcIik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiByZWR1Y2Vyc1trZXldID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBmaW5hbFJlZHVjZXJzW2tleV0gPSByZWR1Y2Vyc1trZXldO1xuICAgIH1cbiAgfVxuXG4gIHZhciBmaW5hbFJlZHVjZXJLZXlzID0gT2JqZWN0LmtleXMoZmluYWxSZWR1Y2Vycyk7IC8vIFRoaXMgaXMgdXNlZCB0byBtYWtlIHN1cmUgd2UgZG9uJ3Qgd2FybiBhYm91dCB0aGUgc2FtZVxuICAvLyBrZXlzIG11bHRpcGxlIHRpbWVzLlxuXG4gIHZhciB1bmV4cGVjdGVkS2V5Q2FjaGU7XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICB1bmV4cGVjdGVkS2V5Q2FjaGUgPSB7fTtcbiAgfVxuXG4gIHZhciBzaGFwZUFzc2VydGlvbkVycm9yO1xuXG4gIHRyeSB7XG4gICAgYXNzZXJ0UmVkdWNlclNoYXBlKGZpbmFsUmVkdWNlcnMpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgc2hhcGVBc3NlcnRpb25FcnJvciA9IGU7XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gY29tYmluYXRpb24oc3RhdGUsIGFjdGlvbikge1xuICAgIGlmIChzdGF0ZSA9PT0gdm9pZCAwKSB7XG4gICAgICBzdGF0ZSA9IHt9O1xuICAgIH1cblxuICAgIGlmIChzaGFwZUFzc2VydGlvbkVycm9yKSB7XG4gICAgICB0aHJvdyBzaGFwZUFzc2VydGlvbkVycm9yO1xuICAgIH1cblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICB2YXIgd2FybmluZ01lc3NhZ2UgPSBnZXRVbmV4cGVjdGVkU3RhdGVTaGFwZVdhcm5pbmdNZXNzYWdlKHN0YXRlLCBmaW5hbFJlZHVjZXJzLCBhY3Rpb24sIHVuZXhwZWN0ZWRLZXlDYWNoZSk7XG5cbiAgICAgIGlmICh3YXJuaW5nTWVzc2FnZSkge1xuICAgICAgICB3YXJuaW5nKHdhcm5pbmdNZXNzYWdlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgaGFzQ2hhbmdlZCA9IGZhbHNlO1xuICAgIHZhciBuZXh0U3RhdGUgPSB7fTtcblxuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBmaW5hbFJlZHVjZXJLZXlzLmxlbmd0aDsgX2krKykge1xuICAgICAgdmFyIF9rZXkgPSBmaW5hbFJlZHVjZXJLZXlzW19pXTtcbiAgICAgIHZhciByZWR1Y2VyID0gZmluYWxSZWR1Y2Vyc1tfa2V5XTtcbiAgICAgIHZhciBwcmV2aW91c1N0YXRlRm9yS2V5ID0gc3RhdGVbX2tleV07XG4gICAgICB2YXIgbmV4dFN0YXRlRm9yS2V5ID0gcmVkdWNlcihwcmV2aW91c1N0YXRlRm9yS2V5LCBhY3Rpb24pO1xuXG4gICAgICBpZiAodHlwZW9mIG5leHRTdGF0ZUZvcktleSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IGdldFVuZGVmaW5lZFN0YXRlRXJyb3JNZXNzYWdlKF9rZXksIGFjdGlvbik7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgICAgfVxuXG4gICAgICBuZXh0U3RhdGVbX2tleV0gPSBuZXh0U3RhdGVGb3JLZXk7XG4gICAgICBoYXNDaGFuZ2VkID0gaGFzQ2hhbmdlZCB8fCBuZXh0U3RhdGVGb3JLZXkgIT09IHByZXZpb3VzU3RhdGVGb3JLZXk7XG4gICAgfVxuXG4gICAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgZmluYWxSZWR1Y2VyS2V5cy5sZW5ndGggIT09IE9iamVjdC5rZXlzKHN0YXRlKS5sZW5ndGg7XG4gICAgcmV0dXJuIGhhc0NoYW5nZWQgPyBuZXh0U3RhdGUgOiBzdGF0ZTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gYmluZEFjdGlvbkNyZWF0b3IoYWN0aW9uQ3JlYXRvciwgZGlzcGF0Y2gpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZGlzcGF0Y2goYWN0aW9uQ3JlYXRvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgfTtcbn1cbi8qKlxuICogVHVybnMgYW4gb2JqZWN0IHdob3NlIHZhbHVlcyBhcmUgYWN0aW9uIGNyZWF0b3JzLCBpbnRvIGFuIG9iamVjdCB3aXRoIHRoZVxuICogc2FtZSBrZXlzLCBidXQgd2l0aCBldmVyeSBmdW5jdGlvbiB3cmFwcGVkIGludG8gYSBgZGlzcGF0Y2hgIGNhbGwgc28gdGhleVxuICogbWF5IGJlIGludm9rZWQgZGlyZWN0bHkuIFRoaXMgaXMganVzdCBhIGNvbnZlbmllbmNlIG1ldGhvZCwgYXMgeW91IGNhbiBjYWxsXG4gKiBgc3RvcmUuZGlzcGF0Y2goTXlBY3Rpb25DcmVhdG9ycy5kb1NvbWV0aGluZygpKWAgeW91cnNlbGYganVzdCBmaW5lLlxuICpcbiAqIEZvciBjb252ZW5pZW5jZSwgeW91IGNhbiBhbHNvIHBhc3MgYW4gYWN0aW9uIGNyZWF0b3IgYXMgdGhlIGZpcnN0IGFyZ3VtZW50LFxuICogYW5kIGdldCBhIGRpc3BhdGNoIHdyYXBwZWQgZnVuY3Rpb24gaW4gcmV0dXJuLlxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb258T2JqZWN0fSBhY3Rpb25DcmVhdG9ycyBBbiBvYmplY3Qgd2hvc2UgdmFsdWVzIGFyZSBhY3Rpb25cbiAqIGNyZWF0b3IgZnVuY3Rpb25zLiBPbmUgaGFuZHkgd2F5IHRvIG9idGFpbiBpdCBpcyB0byB1c2UgRVM2IGBpbXBvcnQgKiBhc2BcbiAqIHN5bnRheC4gWW91IG1heSBhbHNvIHBhc3MgYSBzaW5nbGUgZnVuY3Rpb24uXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZGlzcGF0Y2ggVGhlIGBkaXNwYXRjaGAgZnVuY3Rpb24gYXZhaWxhYmxlIG9uIHlvdXIgUmVkdXhcbiAqIHN0b3JlLlxuICpcbiAqIEByZXR1cm5zIHtGdW5jdGlvbnxPYmplY3R9IFRoZSBvYmplY3QgbWltaWNraW5nIHRoZSBvcmlnaW5hbCBvYmplY3QsIGJ1dCB3aXRoXG4gKiBldmVyeSBhY3Rpb24gY3JlYXRvciB3cmFwcGVkIGludG8gdGhlIGBkaXNwYXRjaGAgY2FsbC4gSWYgeW91IHBhc3NlZCBhXG4gKiBmdW5jdGlvbiBhcyBgYWN0aW9uQ3JlYXRvcnNgLCB0aGUgcmV0dXJuIHZhbHVlIHdpbGwgYWxzbyBiZSBhIHNpbmdsZVxuICogZnVuY3Rpb24uXG4gKi9cblxuXG5mdW5jdGlvbiBiaW5kQWN0aW9uQ3JlYXRvcnMoYWN0aW9uQ3JlYXRvcnMsIGRpc3BhdGNoKSB7XG4gIGlmICh0eXBlb2YgYWN0aW9uQ3JlYXRvcnMgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gYmluZEFjdGlvbkNyZWF0b3IoYWN0aW9uQ3JlYXRvcnMsIGRpc3BhdGNoKTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgYWN0aW9uQ3JlYXRvcnMgIT09ICdvYmplY3QnIHx8IGFjdGlvbkNyZWF0b3JzID09PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiYmluZEFjdGlvbkNyZWF0b3JzIGV4cGVjdGVkIGFuIG9iamVjdCBvciBhIGZ1bmN0aW9uLCBpbnN0ZWFkIHJlY2VpdmVkIFwiICsgKGFjdGlvbkNyZWF0b3JzID09PSBudWxsID8gJ251bGwnIDogdHlwZW9mIGFjdGlvbkNyZWF0b3JzKSArIFwiLiBcIiArIFwiRGlkIHlvdSB3cml0ZSBcXFwiaW1wb3J0IEFjdGlvbkNyZWF0b3JzIGZyb21cXFwiIGluc3RlYWQgb2YgXFxcImltcG9ydCAqIGFzIEFjdGlvbkNyZWF0b3JzIGZyb21cXFwiP1wiKTtcbiAgfVxuXG4gIHZhciBib3VuZEFjdGlvbkNyZWF0b3JzID0ge307XG5cbiAgZm9yICh2YXIga2V5IGluIGFjdGlvbkNyZWF0b3JzKSB7XG4gICAgdmFyIGFjdGlvbkNyZWF0b3IgPSBhY3Rpb25DcmVhdG9yc1trZXldO1xuXG4gICAgaWYgKHR5cGVvZiBhY3Rpb25DcmVhdG9yID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBib3VuZEFjdGlvbkNyZWF0b3JzW2tleV0gPSBiaW5kQWN0aW9uQ3JlYXRvcihhY3Rpb25DcmVhdG9yLCBkaXNwYXRjaCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGJvdW5kQWN0aW9uQ3JlYXRvcnM7XG59XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHtcbiAgaWYgKGtleSBpbiBvYmopIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIG9ialtrZXldID0gdmFsdWU7XG4gIH1cblxuICByZXR1cm4gb2JqO1xufVxuXG5mdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHtcbiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpO1xuXG4gIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7XG4gICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KSk7XG4gIH1cblxuICBpZiAoZW51bWVyYWJsZU9ubHkpIGtleXMgPSBrZXlzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7XG4gICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7XG4gIH0pO1xuICByZXR1cm4ga2V5cztcbn1cblxuZnVuY3Rpb24gX29iamVjdFNwcmVhZDIodGFyZ2V0KSB7XG4gIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307XG5cbiAgICBpZiAoaSAlIDIpIHtcbiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuLyoqXG4gKiBDb21wb3NlcyBzaW5nbGUtYXJndW1lbnQgZnVuY3Rpb25zIGZyb20gcmlnaHQgdG8gbGVmdC4gVGhlIHJpZ2h0bW9zdFxuICogZnVuY3Rpb24gY2FuIHRha2UgbXVsdGlwbGUgYXJndW1lbnRzIGFzIGl0IHByb3ZpZGVzIHRoZSBzaWduYXR1cmUgZm9yXG4gKiB0aGUgcmVzdWx0aW5nIGNvbXBvc2l0ZSBmdW5jdGlvbi5cbiAqXG4gKiBAcGFyYW0gey4uLkZ1bmN0aW9ufSBmdW5jcyBUaGUgZnVuY3Rpb25zIHRvIGNvbXBvc2UuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEEgZnVuY3Rpb24gb2J0YWluZWQgYnkgY29tcG9zaW5nIHRoZSBhcmd1bWVudCBmdW5jdGlvbnNcbiAqIGZyb20gcmlnaHQgdG8gbGVmdC4gRm9yIGV4YW1wbGUsIGNvbXBvc2UoZiwgZywgaCkgaXMgaWRlbnRpY2FsIHRvIGRvaW5nXG4gKiAoLi4uYXJncykgPT4gZihnKGgoLi4uYXJncykpKS5cbiAqL1xuZnVuY3Rpb24gY29tcG9zZSgpIHtcbiAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGZ1bmNzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIGZ1bmNzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICB9XG5cbiAgaWYgKGZ1bmNzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXJnKSB7XG4gICAgICByZXR1cm4gYXJnO1xuICAgIH07XG4gIH1cblxuICBpZiAoZnVuY3MubGVuZ3RoID09PSAxKSB7XG4gICAgcmV0dXJuIGZ1bmNzWzBdO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmNzLnJlZHVjZShmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gYShiLmFwcGx5KHZvaWQgMCwgYXJndW1lbnRzKSk7XG4gICAgfTtcbiAgfSk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIHN0b3JlIGVuaGFuY2VyIHRoYXQgYXBwbGllcyBtaWRkbGV3YXJlIHRvIHRoZSBkaXNwYXRjaCBtZXRob2RcbiAqIG9mIHRoZSBSZWR1eCBzdG9yZS4gVGhpcyBpcyBoYW5keSBmb3IgYSB2YXJpZXR5IG9mIHRhc2tzLCBzdWNoIGFzIGV4cHJlc3NpbmdcbiAqIGFzeW5jaHJvbm91cyBhY3Rpb25zIGluIGEgY29uY2lzZSBtYW5uZXIsIG9yIGxvZ2dpbmcgZXZlcnkgYWN0aW9uIHBheWxvYWQuXG4gKlxuICogU2VlIGByZWR1eC10aHVua2AgcGFja2FnZSBhcyBhbiBleGFtcGxlIG9mIHRoZSBSZWR1eCBtaWRkbGV3YXJlLlxuICpcbiAqIEJlY2F1c2UgbWlkZGxld2FyZSBpcyBwb3RlbnRpYWxseSBhc3luY2hyb25vdXMsIHRoaXMgc2hvdWxkIGJlIHRoZSBmaXJzdFxuICogc3RvcmUgZW5oYW5jZXIgaW4gdGhlIGNvbXBvc2l0aW9uIGNoYWluLlxuICpcbiAqIE5vdGUgdGhhdCBlYWNoIG1pZGRsZXdhcmUgd2lsbCBiZSBnaXZlbiB0aGUgYGRpc3BhdGNoYCBhbmQgYGdldFN0YXRlYCBmdW5jdGlvbnNcbiAqIGFzIG5hbWVkIGFyZ3VtZW50cy5cbiAqXG4gKiBAcGFyYW0gey4uLkZ1bmN0aW9ufSBtaWRkbGV3YXJlcyBUaGUgbWlkZGxld2FyZSBjaGFpbiB0byBiZSBhcHBsaWVkLlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBBIHN0b3JlIGVuaGFuY2VyIGFwcGx5aW5nIHRoZSBtaWRkbGV3YXJlLlxuICovXG5cbmZ1bmN0aW9uIGFwcGx5TWlkZGxld2FyZSgpIHtcbiAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIG1pZGRsZXdhcmVzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIG1pZGRsZXdhcmVzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIChjcmVhdGVTdG9yZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgc3RvcmUgPSBjcmVhdGVTdG9yZS5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cyk7XG5cbiAgICAgIHZhciBfZGlzcGF0Y2ggPSBmdW5jdGlvbiBkaXNwYXRjaCgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEaXNwYXRjaGluZyB3aGlsZSBjb25zdHJ1Y3RpbmcgeW91ciBtaWRkbGV3YXJlIGlzIG5vdCBhbGxvd2VkLiAnICsgJ090aGVyIG1pZGRsZXdhcmUgd291bGQgbm90IGJlIGFwcGxpZWQgdG8gdGhpcyBkaXNwYXRjaC4nKTtcbiAgICAgIH07XG5cbiAgICAgIHZhciBtaWRkbGV3YXJlQVBJID0ge1xuICAgICAgICBnZXRTdGF0ZTogc3RvcmUuZ2V0U3RhdGUsXG4gICAgICAgIGRpc3BhdGNoOiBmdW5jdGlvbiBkaXNwYXRjaCgpIHtcbiAgICAgICAgICByZXR1cm4gX2Rpc3BhdGNoLmFwcGx5KHZvaWQgMCwgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHZhciBjaGFpbiA9IG1pZGRsZXdhcmVzLm1hcChmdW5jdGlvbiAobWlkZGxld2FyZSkge1xuICAgICAgICByZXR1cm4gbWlkZGxld2FyZShtaWRkbGV3YXJlQVBJKTtcbiAgICAgIH0pO1xuICAgICAgX2Rpc3BhdGNoID0gY29tcG9zZS5hcHBseSh2b2lkIDAsIGNoYWluKShzdG9yZS5kaXNwYXRjaCk7XG4gICAgICByZXR1cm4gX29iamVjdFNwcmVhZDIoe30sIHN0b3JlLCB7XG4gICAgICAgIGRpc3BhdGNoOiBfZGlzcGF0Y2hcbiAgICAgIH0pO1xuICAgIH07XG4gIH07XG59XG5cbi8qXG4gKiBUaGlzIGlzIGEgZHVtbXkgZnVuY3Rpb24gdG8gY2hlY2sgaWYgdGhlIGZ1bmN0aW9uIG5hbWUgaGFzIGJlZW4gYWx0ZXJlZCBieSBtaW5pZmljYXRpb24uXG4gKiBJZiB0aGUgZnVuY3Rpb24gaGFzIGJlZW4gbWluaWZpZWQgYW5kIE5PREVfRU5WICE9PSAncHJvZHVjdGlvbicsIHdhcm4gdGhlIHVzZXIuXG4gKi9cblxuZnVuY3Rpb24gaXNDcnVzaGVkKCkge31cblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgdHlwZW9mIGlzQ3J1c2hlZC5uYW1lID09PSAnc3RyaW5nJyAmJiBpc0NydXNoZWQubmFtZSAhPT0gJ2lzQ3J1c2hlZCcpIHtcbiAgd2FybmluZygnWW91IGFyZSBjdXJyZW50bHkgdXNpbmcgbWluaWZpZWQgY29kZSBvdXRzaWRlIG9mIE5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIi4gJyArICdUaGlzIG1lYW5zIHRoYXQgeW91IGFyZSBydW5uaW5nIGEgc2xvd2VyIGRldmVsb3BtZW50IGJ1aWxkIG9mIFJlZHV4LiAnICsgJ1lvdSBjYW4gdXNlIGxvb3NlLWVudmlmeSAoaHR0cHM6Ly9naXRodWIuY29tL3plcnRvc2gvbG9vc2UtZW52aWZ5KSBmb3IgYnJvd3NlcmlmeSAnICsgJ29yIHNldHRpbmcgbW9kZSB0byBwcm9kdWN0aW9uIGluIHdlYnBhY2sgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uY2VwdHMvbW9kZS8pICcgKyAndG8gZW5zdXJlIHlvdSBoYXZlIHRoZSBjb3JyZWN0IGNvZGUgZm9yIHlvdXIgcHJvZHVjdGlvbiBidWlsZC4nKTtcbn1cblxuZXhwb3J0IHsgQWN0aW9uVHlwZXMgYXMgX19ET19OT1RfVVNFX19BY3Rpb25UeXBlcywgYXBwbHlNaWRkbGV3YXJlLCBiaW5kQWN0aW9uQ3JlYXRvcnMsIGNvbWJpbmVSZWR1Y2VycywgY29tcG9zZSwgY3JlYXRlU3RvcmUgfTtcbiIsIi8qIGdsb2JhbCB3aW5kb3cgKi9cbmltcG9ydCBwb255ZmlsbCBmcm9tICcuL3BvbnlmaWxsLmpzJztcblxudmFyIHJvb3Q7XG5cbmlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgcm9vdCA9IHNlbGY7XG59IGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gIHJvb3QgPSB3aW5kb3c7XG59IGVsc2UgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7XG4gIHJvb3QgPSBnbG9iYWw7XG59IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gIHJvb3QgPSBtb2R1bGU7XG59IGVsc2Uge1xuICByb290ID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcbn1cblxudmFyIHJlc3VsdCA9IHBvbnlmaWxsKHJvb3QpO1xuZXhwb3J0IGRlZmF1bHQgcmVzdWx0O1xuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc3ltYm9sT2JzZXJ2YWJsZVBvbnlmaWxsKHJvb3QpIHtcblx0dmFyIHJlc3VsdDtcblx0dmFyIFN5bWJvbCA9IHJvb3QuU3ltYm9sO1xuXG5cdGlmICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0aWYgKFN5bWJvbC5vYnNlcnZhYmxlKSB7XG5cdFx0XHRyZXN1bHQgPSBTeW1ib2wub2JzZXJ2YWJsZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmVzdWx0ID0gU3ltYm9sKCdvYnNlcnZhYmxlJyk7XG5cdFx0XHRTeW1ib2wub2JzZXJ2YWJsZSA9IHJlc3VsdDtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0cmVzdWx0ID0gJ0BAb2JzZXJ2YWJsZSc7XG5cdH1cblxuXHRyZXR1cm4gcmVzdWx0O1xufTtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgY29tcG9zZSA9IHJlcXVpcmUoJ3JlZHV4JykuY29tcG9zZTtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHMuY29tcG9zZVdpdGhEZXZUb29scyA9IChcbiAgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Ll9fUkVEVVhfREVWVE9PTFNfRVhURU5TSU9OX0NPTVBPU0VfXyA/XG4gICAgd2luZG93Ll9fUkVEVVhfREVWVE9PTFNfRVhURU5TSU9OX0NPTVBPU0VfXyA6XG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIGlmICh0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnb2JqZWN0JykgcmV0dXJuIGNvbXBvc2U7XG4gICAgICByZXR1cm4gY29tcG9zZS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgIH1cbik7XG5cbmV4cG9ydHMuZGV2VG9vbHNFbmhhbmNlciA9IChcbiAgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Ll9fUkVEVVhfREVWVE9PTFNfRVhURU5TSU9OX18gP1xuICAgIHdpbmRvdy5fX1JFRFVYX0RFVlRPT0xTX0VYVEVOU0lPTl9fIDpcbiAgICBmdW5jdGlvbigpIHsgcmV0dXJuIGZ1bmN0aW9uKG5vb3ApIHsgcmV0dXJuIG5vb3A7IH0gfVxuKTtcbiIsInZhciBnO1xuXG4vLyBUaGlzIHdvcmtzIGluIG5vbi1zdHJpY3QgbW9kZVxuZyA9IChmdW5jdGlvbigpIHtcblx0cmV0dXJuIHRoaXM7XG59KSgpO1xuXG50cnkge1xuXHQvLyBUaGlzIHdvcmtzIGlmIGV2YWwgaXMgYWxsb3dlZCAoc2VlIENTUClcblx0ZyA9IGcgfHwgbmV3IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKTtcbn0gY2F0Y2ggKGUpIHtcblx0Ly8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGVcblx0aWYgKHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIpIGcgPSB3aW5kb3c7XG59XG5cbi8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi5cbi8vIFdlIHJldHVybiB1bmRlZmluZWQsIGluc3RlYWQgb2Ygbm90aGluZyBoZXJlLCBzbyBpdCdzXG4vLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59XG5cbm1vZHVsZS5leHBvcnRzID0gZztcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob3JpZ2luYWxNb2R1bGUpIHtcblx0aWYgKCFvcmlnaW5hbE1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcblx0XHR2YXIgbW9kdWxlID0gT2JqZWN0LmNyZWF0ZShvcmlnaW5hbE1vZHVsZSk7XG5cdFx0Ly8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0XG5cdFx0aWYgKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGUsIFwibG9hZGVkXCIsIHtcblx0XHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmw7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJpZFwiLCB7XG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIG1vZHVsZS5pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGUsIFwiZXhwb3J0c1wiLCB7XG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlXG5cdFx0fSk7XG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XG5cdH1cblx0cmV0dXJuIG1vZHVsZTtcbn07XG4iLCJjb25zdCBwbGF5ZXJFbnVtcyA9IHtcbiAgICBQTEFZSU5HOiBcIlBMQVlJTkdcIixcbiAgICBTVE9QUEVEOiBcIlNUT1BQRURcIixcbiAgICBQQVVTRUQ6IFwiUEFVU0VEXCIsXG4gICAgU0VFS0lORzogXCJTRUVLSU5HXCIsXG4gICAgU1RBTExFRDogXCJTVEFMTEVEXCIsXG4gICAgRU5ERUQ6IFwiRU5ERURcIlxufVxuXG5jb25zdCBwbGF5ZXJBY3Rpb25zID0ge1xuICAgIFRJTUVfVVBEQVRFOiBcIlRJTUVfVVBEQVRFXCIsXG4gICAgQUJTT0xVVEVfVElNRV9VUERBVEU6IFwiQUJTT0xVVEVfVElNRV9VUERBVEVcIixcbiAgICBTRVRfQkVBQ09OOiBcIlNFVF9CRUFDT05cIixcbiAgICBDTEVBUl9CRUFDT05TOiBcIkNMRUFSX0JFQUNPTlNcIixcbiAgICBQTEFZX1NUQVRFOiBcIlBMQVlfU1RBVEVcIixcbiAgICBQQVVTRV9TVEFURTogXCJQQVVTRV9TVEFURVwiLFxuICAgIFNUQUxMRURfU1RBVEU6IFwiU1RBTExFRF9TVEFURVwiLFxuICAgIFNFRUtJTkdfU1RBVEU6IFwiU0VFS0lOR19TVEFURVwiLFxuICAgIFNUT1BQRURfU1RBVEU6IFwiU1RPUFBFRF9TVEFURVwiLFxuICAgIE5FWFRfQ0xJUDogXCJORVhUX0NMSVBcIixcbiAgICBQUkVWX0NMSVA6IFwiUFJFVl9DTElQXCIsXG4gICAgU1dJVENIX0NMSVA6IFwiU1dJVENIX0NMSVBcIixcbiAgICBDTElQTElTVF9VUERBVEU6IFwiQ0xJUExJU1RfVVBEQVRFXCIsXG4gICAgQ0xJUF9FTkRFRDogXCJDTElQX0VOREVEXCIsXG4gICAgU0VUX1RJTUVfU0hJRlRBQkxFOiBcIlNFVF9USU1FX1NISUZUQUJMRVwiXG59XG5cbmNvbnN0IGJlYWNvblR5cGVzID0ge1xuICAgIERFRkFVTFRfSU1QUkVTU0lPTjogXCJkZWZhdWx0SW1wcmVzc2lvblwiLFxuICAgIEZJUlNUX1FVQVJUSUxFOiBcImZpcnN0UXVhcnRpbGVcIixcbiAgICBNSURXQVk6IFwibWlkd2F5XCIsXG4gICAgVEhJUkRfUVVBUlRJTEU6IFwidGhpcmRRdWFydGlsZVwiLFxuICAgIENPTVBMRVRFOiBcImNvbXBsZXRlXCJcbn1cblxuZXhwb3J0IHtcbiAgICBwbGF5ZXJFbnVtcyxcbiAgICBwbGF5ZXJBY3Rpb25zLFxuICAgIGJlYWNvblR5cGVzXG59IiwiaW1wb3J0IHsgcGxheWVyQWN0aW9ucyB9IGZyb20gJy4uL3R5cGVzL3BsYXllckVudW1zJztcblxuY29uc3QgdGltZVVwZGF0ZSA9IChtc0luY3JlbWVudCwgcGxheWVyVGltZSkgPT4gKHtcbiAgICB0eXBlOiBwbGF5ZXJBY3Rpb25zLlRJTUVfVVBEQVRFLFxuICAgIG1zSW5jcmVtZW50LFxuICAgIHBsYXllclRpbWVcbn0pO1xuXG5jb25zdCBzZXRBYm9zbHV0ZVRpbWVsaW5lID0gKG5ld1RpbWUpID0+ICh7XG4gICAgdHlwZTogcGxheWVyQWN0aW9ucy5BQlNPTFVURV9USU1FX1VQREFURSxcbiAgICBwYXlsb2FkOiBuZXdUaW1lXG59KTtcblxuY29uc3Qgc2V0QmVhY29uID0gKGJlYWNvbikgPT4gKHtcbiAgICB0eXBlOiBwbGF5ZXJBY3Rpb25zLlNFVF9CRUFDT04sXG4gICAgcGF5bG9hZDogYmVhY29uXG59KTtcblxuY29uc3QgY2xlYXJCZWFjb25zID0gKCkgPT4gKHtcbiAgICB0eXBlOiBwbGF5ZXJBY3Rpb25zLkNMRUFSX0JFQUNPTlNcbn0pO1xuXG5jb25zdCBzZXRUaW1lU2hpZnRhYmxlID0gKHRpbWVTaGlmdGFibGUpID0+ICh7XG4gICAgdHlwZTogcGxheWVyQWN0aW9ucy5TRVRfVElNRV9TSElGVEFCTEUsXG4gICAgcGF5bG9hZDogdGltZVNoaWZ0YWJsZVxufSlcblxuY29uc3QgcGxheVN0YXRlID0gKCkgPT4gKHtcbiAgICB0eXBlOiBwbGF5ZXJBY3Rpb25zLlBMQVlfU1RBVEVcbn0pO1xuXG5jb25zdCBwYXVzZVN0YXRlID0gKCkgPT4gKHtcbiAgICB0eXBlOiBwbGF5ZXJBY3Rpb25zLlBBVVNFX1NUQVRFXG59KTtcblxuY29uc3Qgc3RhbGxlZFN0YXRlID0gKCkgPT4gKHtcbiAgICB0eXBlOiBwbGF5ZXJBY3Rpb25zLlNUQUxMRURfU1RBVEVcbn0pO1xuXG5jb25zdCBzdG9wcGVkU3RhdGUgPSAoKSA9PiAoe1xuICAgIHR5cGU6IHBsYXllckFjdGlvbnMuU1RPUFBFRF9TVEFURVxufSk7XG5cbmNvbnN0IHNlZWtpbmdTdGF0ZSA9ICgpID0+ICh7XG4gICAgdHlwZTogcGxheWVyQWN0aW9ucy5TRUVLSU5HX1NUQVRFXG59KTtcblxuY29uc3QgbmV4dENsaXAgPSAoKSA9PiAoe1xuICAgIHR5cGU6IHBsYXllckFjdGlvbnMuTkVYVF9DTElQXG59KTtcblxuY29uc3QgcHJldkNsaXAgPSAoKSA9PiAoe1xuICAgIHR5cGU6IHBsYXllckFjdGlvbnMuUFJFVl9DTElQXG59KTtcblxuY29uc3Qgc3dpdGNoQ2xpcCA9IChjbGlwSW5kZXgpID0+ICh7XG4gICAgdHlwZTogcGxheWVyQWN0aW9ucy5TV0lUQ0hfQ0xJUCxcbiAgICBjbGlwSW5kZXhcbn0pO1xuXG5jb25zdCBjbGlwRW5kZWQgPSAoKSA9PiAoe1xuICAgIHR5cGU6IHBsYXllckFjdGlvbnMuQ0xJUF9FTkRFRFxufSlcblxuY29uc3QgdXBkYXRlQ2xpcExpc3QgPSAoY2xpcExpc3QsIGN1cnJlbnRDbGlwSW5kZXgpID0+ICh7XG4gICAgdHlwZTogcGxheWVyQWN0aW9ucy5DTElQTElTVF9VUERBVEUsXG4gICAgYXNzZXRDbGlwTGlzdDoge1xuICAgICAgICBjbGlwTGlzdCxcbiAgICAgICAgY3VycmVudENsaXBJbmRleFxuICAgIH1cbn0pO1xuXG5leHBvcnQge1xuICAgIHRpbWVVcGRhdGUsXG4gICAgc2V0QWJvc2x1dGVUaW1lbGluZSxcbiAgICBzZXRCZWFjb24sXG4gICAgY2xlYXJCZWFjb25zLFxuICAgIHNldFRpbWVTaGlmdGFibGUsXG4gICAgcGxheVN0YXRlLFxuICAgIHBhdXNlU3RhdGUsXG4gICAgc3RhbGxlZFN0YXRlLFxuICAgIHN0b3BwZWRTdGF0ZSxcbiAgICBzZWVraW5nU3RhdGUsXG4gICAgbmV4dENsaXAsXG4gICAgcHJldkNsaXAsXG4gICAgc3dpdGNoQ2xpcCxcbiAgICB1cGRhdGVDbGlwTGlzdCxcbiAgICBjbGlwRW5kZWRcbn0iLCJjb25zdCBnZXRXaG9sZVBsYXllclRpbWUgPSBmdW5jdGlvbihwbGF5ZXJUaW1lKSB7XG4gICAgcmV0dXJuIE1hdGguY2VpbChwbGF5ZXJUaW1lLzEwMCkgKiAxMDA7XG59XG5cbmNvbnN0IGNvbnZlcnRUb01pbGxpc2Vjb25kcyA9IGZ1bmN0aW9uKHRpbWUpIHtcbiAgICByZXR1cm4gdGltZSAqIDEwMDA7XG59XG5cbmNvbnN0IGNvbnZlcnRUb1NlY29uZHMgPSBmdW5jdGlvbih0aW1lKSB7XG4gICAgcmV0dXJuIHRpbWUgLyAxMDAwO1xufVxuXG5leHBvcnQge1xuICAgIGdldFdob2xlUGxheWVyVGltZSxcbiAgICBjb252ZXJ0VG9NaWxsaXNlY29uZHMsXG4gICAgY29udmVydFRvU2Vjb25kc1xufSIsImltcG9ydCB7IGNvbWJpbmVSZWR1Y2VycyB9IGZyb20gJ3JlZHV4JztcbmltcG9ydCB7IHBsYXllckVudW1zLCBwbGF5ZXJBY3Rpb25zIH0gZnJvbSAnLi4vdHlwZXMvcGxheWVyRW51bXMuanMnXG5cbmNvbnN0IHRpbWVsaW5lUmVkdWNlciA9ICh0aW1lT2JqZWN0ID0ge2FwanNUaW1lOiAwLCBwbGF5ZXJUaW1lOiAwLCBiZWFjb25zOiBbXSwgdGltZVNoaWZ0YWJsZTogdHJ1ZX0sIGFjdGlvbikgPT4ge1xuICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAgICAgY2FzZSBwbGF5ZXJBY3Rpb25zLlRJTUVfVVBEQVRFOlxuICAgICAgICAgICAgdGltZU9iamVjdC5hcGpzVGltZSArPSBhY3Rpb24ubXNJbmNyZW1lbnQ7XG4gICAgICAgICAgICB0aW1lT2JqZWN0LnBsYXllclRpbWUgPSBhY3Rpb24ucGxheWVyVGltZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIHBsYXllckFjdGlvbnMuQUJTT0xVVEVfVElNRV9VUERBVEU6XG4gICAgICAgICAgICB0aW1lT2JqZWN0LmFwanNUaW1lID0gYWN0aW9uLnBheWxvYWQ7XG4gICAgICAgICAgICB0aW1lT2JqZWN0LnBsYXllclRpbWUgPSBhY3Rpb24ucGF5bG9hZDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIHBsYXllckFjdGlvbnMuU0VUX0JFQUNPTjpcbiAgICAgICAgICAgIGxldCBpbmRleCA9IHRpbWVPYmplY3QuYmVhY29ucy5maW5kSW5kZXgoYmVhY29uID0+IGJlYWNvbi50eXBlID09PSBhY3Rpb24ucGF5bG9hZC50eXBlICYmIGJlYWNvbi50aW1lSW5kZXggPT09IGFjdGlvbi5wYXlsb2FkLnRpbWVJbmRleCk7XG4gICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGltZU9iamVjdC5iZWFjb25zLnNwbGljZShpbmRleCwgYWN0aW9uLnBheWxvYWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aW1lT2JqZWN0LmJlYWNvbnMucHVzaChhY3Rpb24ucGF5bG9hZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBwbGF5ZXJBY3Rpb25zLkNMRUFSX0JFQUNPTlM6XG4gICAgICAgICAgICB0aW1lT2JqZWN0LmJlYWNvbnMgPSBbXTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIHBsYXllckFjdGlvbnMuU0VUX1RJTUVfU0hJRlRBQkxFOlxuICAgICAgICAgICAgdGltZU9iamVjdC50aW1lU2hpZnRhYmxlID0gYWN0aW9uLnBheWxvYWQ7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4gdGltZU9iamVjdDtcbn1cblxuY29uc3QgcGxheWVyU3RhdGVSZWR1Y2VyID0gKHBsYXllclN0YXRlID0gcGxheWVyRW51bXMuU1RPUFBFRCwgYWN0aW9uKSA9PiB7XG4gICAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xuICAgICAgICBjYXNlIHBsYXllckFjdGlvbnMuU1RPUFBFRF9TVEFURTpcbiAgICAgICAgICAgIHBsYXllclN0YXRlID0gcGxheWVyRW51bXMuU1RPUFBFRDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIHBsYXllckFjdGlvbnMuUExBWV9TVEFURTpcbiAgICAgICAgICAgIHBsYXllclN0YXRlID0gcGxheWVyRW51bXMuUExBWUlORztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIHBsYXllckFjdGlvbnMuUEFVU0VfU1RBVEU6XG4gICAgICAgICAgICBwbGF5ZXJTdGF0ZSA9IHBsYXllckVudW1zLlBBVVNFRDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIHBsYXllckFjdGlvbnMuU1RBTExFRF9TVEFURTpcbiAgICAgICAgICAgIHBsYXllclN0YXRlID0gcGxheWVyRW51bXMuU1RBTExFRDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIHBsYXllckFjdGlvbnMuU0VFS0lOR19TVEFURTpcbiAgICAgICAgICAgIHBsYXllclN0YXRlID0gcGxheWVyRW51bXMuU0VFS0lORztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIHBsYXllckFjdGlvbnMuQ0xJUF9FTkRFRDpcbiAgICAgICAgICAgIHBsYXllclN0YXRlID0gcGxheWVyRW51bXMuRU5ERUQ7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIHBsYXllclN0YXRlXG59XG5cbmNvbnN0IGNsaXBMaXN0UmVkdWNlciA9IChhc3NldENsaXBMaXN0ID0ge2NsaXBMaXN0OiBbXSwgY3VycmVudENsaXBJbmRleDogMH0sIGFjdGlvbikgPT4ge1xuICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAgICAgY2FzZSBwbGF5ZXJBY3Rpb25zLk5FWFRfQ0xJUDpcbiAgICAgICAgICAgIGFzc2V0Q2xpcExpc3QuY3VycmVudENsaXBJbmRleCsrO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgcGxheWVyQWN0aW9ucy5QUkVWX0NMSVA6XG4gICAgICAgICAgICBhc3NldENsaXBMaXN0LmN1cnJlbnRDbGlwSW5kZXgtLTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIHBsYXllckFjdGlvbnMuU1dJVENIX0NMSVA6XG4gICAgICAgICAgICBhc3NldENsaXBMaXN0LmN1cnJlbnRDbGlwSW5kZXggPSBhY3Rpb24uY2xpcEluZGV4O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgcGxheWVyQWN0aW9ucy5DTElQTElTVF9VUERBVEU6XG4gICAgICAgICAgICBhc3NldENsaXBMaXN0ID0gYWN0aW9uLmFzc2V0Q2xpcExpc3Q7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4gYXNzZXRDbGlwTGlzdDtcbn1cblxubGV0IGFwSlNSZWR1Y2VycyA9IGNvbWJpbmVSZWR1Y2Vycyh7XG4gICAgcGxheWVyU3RhdGVSZWR1Y2VyLFxuICAgIGNsaXBMaXN0UmVkdWNlclxufSlcblxuZXhwb3J0IHtcbiAgICB0aW1lbGluZVJlZHVjZXIsXG4gICAgcGxheWVyU3RhdGVSZWR1Y2VyLFxuICAgIGNsaXBMaXN0UmVkdWNlcixcbiAgICBhcEpTUmVkdWNlcnNcbn0iLCJpbXBvcnQgeyBjcmVhdGVTdG9yZSB9IGZyb20gJ3JlZHV4JztcbmltcG9ydCB7IHRpbWVsaW5lUmVkdWNlciwgYXBKU1JlZHVjZXJzIH0gZnJvbSAnLi4vcmVkdWNlcnMvaW5kZXguanMnO1xuaW1wb3J0IHsgY29tcG9zZVdpdGhEZXZUb29scyB9IGZyb20gJ3JlZHV4LWRldnRvb2xzLWV4dGVuc2lvbic7XG5cbmNvbnN0IGNvbXBvc2VFbmhhbmNlcnMgPSBjb21wb3NlV2l0aERldlRvb2xzKHsgcmVhbHRpbWU6IHRydWUgfSk7XG5jb25zdCB0aW1lbGluZVN0b3JlID0gY3JlYXRlU3RvcmUodGltZWxpbmVSZWR1Y2VyLCBjb21wb3NlRW5oYW5jZXJzKCkpO1xuY29uc3QgYXBqc1N0b3JlID0gY3JlYXRlU3RvcmUoYXBKU1JlZHVjZXJzLCBjb21wb3NlRW5oYW5jZXJzKCkpO1xuXG5leHBvcnQge1xuICAgIHRpbWVsaW5lU3RvcmUsXG4gICAgYXBqc1N0b3JlXG59IiwiaW1wb3J0IHsgYmVhY29uVHlwZXMgfSBmcm9tICcuL3BsYXllckVudW1zLmpzJztcblxuXG5leHBvcnQgZGVmYXVsdCBbXG4gICAgYmVhY29uVHlwZXMuREVGQVVMVF9JTVBSRVNTSU9OLFxuICAgIGJlYWNvblR5cGVzLkZJUlNUX1FVQVJUSUxFLFxuICAgIGJlYWNvblR5cGVzLk1JRFdBWSxcbiAgICBiZWFjb25UeXBlcy5USElSRF9RVUFSVElMRSxcbiAgICBiZWFjb25UeXBlcy5DT01QTEVURVxuXSIsImltcG9ydCB7IGJlYWNvblR5cGVzIH0gZnJvbSAnLi90eXBlcy9wbGF5ZXJFbnVtcy5qcydcbmltcG9ydCBiZWFjb25zIGZyb20gJy4vdHlwZXMvYmVhY29ucy5qcyc7XG5pbXBvcnQgeyB0aW1lbGluZVN0b3JlIH0gZnJvbSAnLi9zdG9yZS9pbmRleC5qcyc7XG5pbXBvcnQgeyBzZXRCZWFjb24sIHNldFRpbWVTaGlmdGFibGUgfSBmcm9tICcuL2FjdGlvbnMvaW5kZXguanMnO1xuaW1wb3J0IHsgY29udmVydFRvTWlsbGlzZWNvbmRzIH0gZnJvbSAnLi91dGlscy5qcyc7XG5cbmNvbnN0IEFEX1RJTUVfTUlMTElTRUNPTkRTID0gMTUwMDA7XG5cbmxldCBCZWFjb25VdGlscyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgbGV0IGhhbmRsZUJlYWNvblRpbWVsaW5lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBjdXJyZW50QVBKU1RpbWVNUyA9IHRpbWVsaW5lU3RvcmUuZ2V0U3RhdGUoKS5hcGpzVGltZTtcbiAgICAgICAgbGV0IGJlYWNvbnMgPSB0aW1lbGluZVN0b3JlLmdldFN0YXRlKCkuYmVhY29ucztcbiAgICAgICAgbGV0IHBlbmRpbmdCZWFjb25zID0gYmVhY29ucy5maWx0ZXIoYmVhY29uID0+ICFiZWFjb24uaXNGaXJlZCk7XG4gICAgICAgIGlmIChwZW5kaW5nQmVhY29ucyAmJiBBcnJheS5pc0FycmF5KHBlbmRpbmdCZWFjb25zKSAmJiBwZW5kaW5nQmVhY29ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBpZiAocGVuZGluZ0JlYWNvbnNbMF0udGltZUluZGV4IDw9IGN1cnJlbnRBUEpTVGltZU1TKSB7XG4gICAgICAgICAgICAgICAgcGVuZGluZ0JlYWNvbnNbMF0uaXNGaXJlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGltZWxpbmVTdG9yZS5kaXNwYXRjaChzZXRCZWFjb24ocGVuZGluZ0JlYWNvbnNbMF0pKTtcbiAgICAgICAgICAgICAgICB0aW1lbGluZVN0b3JlLmRpc3BhdGNoKHNldFRpbWVTaGlmdGFibGUoZmFsc2UpKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkJlYWNvbiBldmVudCBmaXJlZDogXCIsIHBlbmRpbmdCZWFjb25zWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIFxuICAgICAgICBsZXQgaXNUaW1lU2hpZnRhYmxlID0gdGltZWxpbmVTdG9yZS5nZXRTdGF0ZSgpLnRpbWVTaGlmdGFibGU7XG4gICAgICAgIGxldCBsYXN0RmlyZWRCZWFjb24gPSBiZWFjb25zLmZpbHRlcihiZWFjb24gPT4gYmVhY29uLmlzRmlyZWQpO1xuICAgICAgICBpZiAobGFzdEZpcmVkQmVhY29uICYmIEFycmF5LmlzQXJyYXkobGFzdEZpcmVkQmVhY29uKSAmJiBsYXN0RmlyZWRCZWFjb24ubGVuZ3RoID4gMCAmJiAhaXNUaW1lU2hpZnRhYmxlKSB7XG4gICAgICAgICAgICBpZiAobGFzdEZpcmVkQmVhY29uW2xhc3RGaXJlZEJlYWNvbi5sZW5ndGggLSAxXS50aW1lSW5kZXggKyBBRF9USU1FX01JTExJU0VDT05EUyA8PSBjdXJyZW50QVBKU1RpbWVNUykge1xuICAgICAgICAgICAgICAgIHRpbWVsaW5lU3RvcmUuZGlzcGF0Y2goc2V0VGltZVNoaWZ0YWJsZSh0cnVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBsZXQgd2F0Y2hCZWFjb25UaW1lbGluZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aW1lbGluZVN0b3JlLnN1YnNjcmliZShoYW5kbGVCZWFjb25UaW1lbGluZSlcbiAgICB9XG5cbiAgICBsZXQgcHJvY2Vzc0JlYWNvbnMgPSBmdW5jdGlvbihhc3NldER1cmF0aW9uKSB7XG4gICAgICAgIGJlYWNvbnMubWFwKGJlYWNvblR5cGUgPT4ge1xuICAgICAgICAgICAgbGV0IHRpbWVJbmRleCA9IDA7XG4gICAgICAgICAgICBzd2l0Y2ggKGJlYWNvblR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIGJlYWNvblR5cGVzLkRFRkFVTFRfSU1QUkVTU0lPTjpcbiAgICAgICAgICAgICAgICAgICAgdGltZUluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBiZWFjb25UeXBlcy5GSVJTVF9RVUFSVElMRTpcbiAgICAgICAgICAgICAgICAgICAgdGltZUluZGV4ID0gYXNzZXREdXJhdGlvbiAqIC4yNTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBiZWFjb25UeXBlcy5NSURXQVk6IFxuICAgICAgICAgICAgICAgICAgICB0aW1lSW5kZXggPSBhc3NldER1cmF0aW9uIC8gMjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBiZWFjb25UeXBlcy5USElSRF9RVUFSVElMRTpcbiAgICAgICAgICAgICAgICAgICAgdGltZUluZGV4ID0gYXNzZXREdXJhdGlvbiAqIC43NTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBiZWFjb25UeXBlcy5DT01QTEVURTpcbiAgICAgICAgICAgICAgICAgICAgdGltZUluZGV4ID0gYXNzZXREdXJhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICBsZXQgYmVhY29uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6IGJlYWNvblR5cGUsXG4gICAgICAgICAgICAgICAgdGltZUluZGV4OiBjb252ZXJ0VG9NaWxsaXNlY29uZHModGltZUluZGV4KSxcbiAgICAgICAgICAgICAgICBpc0ZpcmVkOiBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGltZWxpbmVTdG9yZS5kaXNwYXRjaChzZXRCZWFjb24oYmVhY29uKSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHByb2Nlc3NCZWFjb25zLFxuICAgICAgICB3YXRjaEJlYWNvblRpbWVsaW5lXG4gICAgfVxufSgpO1xuXG5leHBvcnQgZGVmYXVsdCBCZWFjb25VdGlsczsiLCJleHBvcnQgZGVmYXVsdCBbXG4gICAge1xuICAgICAgICB1cmw6IFwiaHR0cHM6Ly9tZWRpYS53My5vcmcvMjAxMC8wNS9zaW50ZWwvdHJhaWxlci5tcDRcIlxuICAgIH0sXG4gICAge1xuICAgICAgICB1cmw6IFwiaHR0cDovL2NvbW1vbmRhdGFzdG9yYWdlLmdvb2dsZWFwaXMuY29tL2d0di12aWRlb3MtYnVja2V0L3NhbXBsZS9CaWdCdWNrQnVubnkubXA0XCJcbiAgICB9LFxuICAgIHtcbiAgICAgICAgdXJsOiBcImh0dHA6Ly9jb21tb25kYXRhc3RvcmFnZS5nb29nbGVhcGlzLmNvbS9ndHYtdmlkZW9zLWJ1Y2tldC9zYW1wbGUvRWxlcGhhbnRzRHJlYW0ubXA0XCJcbiAgICB9XG5dIiwiaW1wb3J0IHsgdGltZVVwZGF0ZSwgcGxheVN0YXRlLCBwYXVzZVN0YXRlLCBzdGFsbGVkU3RhdGUsIHN0b3BwZWRTdGF0ZSwgc2Vla2luZ1N0YXRlLCBuZXh0Q2xpcCwgdXBkYXRlQ2xpcExpc3QsIGNsaXBFbmRlZCwgc2V0QWJvc2x1dGVUaW1lbGluZSwgc2V0QmVhY29uLCBjbGVhckJlYWNvbnMsIHNldFRpbWVTaGlmdGFibGUgfSBmcm9tICcuL2FjdGlvbnMvaW5kZXguanMnO1xuaW1wb3J0IHsgZ2V0V2hvbGVQbGF5ZXJUaW1lLCBjb252ZXJ0VG9NaWxsaXNlY29uZHMsIGNvbnZlcnRUb1NlY29uZHN9IGZyb20gJy4vdXRpbHMuanMnO1xuaW1wb3J0IHsgdGltZWxpbmVTdG9yZSwgYXBqc1N0b3JlIH0gZnJvbSAnLi9zdG9yZS9pbmRleC5qcyc7XG5pbXBvcnQgeyBwbGF5ZXJFbnVtcyB9IGZyb20gJy4vdHlwZXMvcGxheWVyRW51bXMuanMnO1xuaW1wb3J0IEJlYWNvblV0aWxzIGZyb20gJy4vYmVhY29uVXRpbHMuanMnO1xuaW1wb3J0IENsaXBMaXN0IGZyb20gJy4vdHlwZXMvY2xpcExpc3QuanMnO1xuXG5jb25zdCBpbnRlcnZhbFRpbWUgPSAxMDA7XG5jb25zdCBTVEFMTEVEX1RIUkVTSE9MRCA9IDEwMDAwO1xubGV0IHNhbXBsZVZpZGVvUGxheWVyO1xubGV0IHRpbWVsaW5lSW50ZXJ2YWw7XG5cbiQoZnVuY3Rpb24oKSB7XG4gICAgc2FtcGxlVmlkZW9QbGF5ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNhbXBsZVZpZGVvUGxheWVyXCIpO1xuICAgIHNhbXBsZVZpZGVvUGxheWVyLm9ucGxheSA9ICgpID0+IHtcbiAgICAgICAgQmVhY29uVXRpbHMucHJvY2Vzc0JlYWNvbnMoc2FtcGxlVmlkZW9QbGF5ZXIuZHVyYXRpb24pO1xuICAgICAgICBhcGpzU3RvcmUuZGlzcGF0Y2gocGxheVN0YXRlKCkpO1xuICAgICAgICBpbml0VGltZXIoKTtcbiAgICB9O1xuICAgIHNhbXBsZVZpZGVvUGxheWVyLm9ucGF1c2UgPSAoKSA9PiB7XG4gICAgICAgIGFwanNTdG9yZS5kaXNwYXRjaChwYXVzZVN0YXRlKCkpO1xuICAgICAgICBjbGVhckludGVydmFsKHRpbWVsaW5lSW50ZXJ2YWwpO1xuICAgIH1cbiAgICBzYW1wbGVWaWRlb1BsYXllci5vbnN0YWxsZWQgPSAoKSA9PiB7XG4gICAgICAgIGFwanNTdG9yZS5kaXNwYXRjaChzdGFsbGVkU3RhdGUoKSk7XG4gICAgfVxuICAgIHNhbXBsZVZpZGVvUGxheWVyLm9uc2Vla2luZyA9ICgpID0+IHtcbiAgICAgICAgYXBqc1N0b3JlLmRpc3BhdGNoKHNlZWtpbmdTdGF0ZSgpKTtcbiAgICB9XG4gICAgc2FtcGxlVmlkZW9QbGF5ZXIub25zZWVrZWQgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgdGltZWxpbmVTdG9yZS5kaXNwYXRjaChzZXRBYm9zbHV0ZVRpbWVsaW5lKGdldFdob2xlUGxheWVyVGltZShjb252ZXJ0VG9NaWxsaXNlY29uZHMoc2FtcGxlVmlkZW9QbGF5ZXIuY3VycmVudFRpbWUpKSkpO1xuICAgIH07XG4gICAgc2FtcGxlVmlkZW9QbGF5ZXIub25lbmRlZCA9ICgpID0+IHtcbiAgICAgICAgYXBqc1N0b3JlLmRpc3BhdGNoKGNsaXBFbmRlZCgpKTtcbiAgICAgICAgbGV0IGFwanNTdG9yZVN0YXRlID0gYXBqc1N0b3JlLmdldFN0YXRlKCk7XG4gICAgICAgIGlmIChhcGpzU3RvcmVTdGF0ZSkge1xuICAgICAgICAgICAgbGV0IGN1cnJlbnRDbGlwSW5kZXggPSBhcGpzU3RvcmVTdGF0ZS5jbGlwTGlzdFJlZHVjZXIuY3VycmVudENsaXBJbmRleCB8fCAwO1xuICAgICAgICAgICAgbGV0IGNsaXBMaXN0RnJvbVN0b3JlID0gYXBqc1N0b3JlU3RhdGUuY2xpcExpc3RSZWR1Y2VyLmNsaXBMaXN0O1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRDbGlwSW5kZXggKyAxIDwgY2xpcExpc3RGcm9tU3RvcmUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGltZWxpbmVTdG9yZS5kaXNwYXRjaChzZXRBYm9zbHV0ZVRpbWVsaW5lKDApKTtcbiAgICAgICAgICAgICAgICB0aW1lbGluZVN0b3JlLmRpc3BhdGNoKGNsZWFyQmVhY29ucygpKTtcbiAgICAgICAgICAgICAgICBhcGpzU3RvcmUuZGlzcGF0Y2gobmV4dENsaXAoKSk7XG4gICAgICAgICAgICAgICAgbG9hZFZpZGVvU3JjKHNhbXBsZVZpZGVvUGxheWVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzYW1wbGVWaWRlb1BsYXllci5vbmxvYWRlZGRhdGEgPSAoKSA9PiB7XG4gICAgICAgIGxldCBhcGpzU3RvcmVTdGF0ZSA9IGFwanNTdG9yZS5nZXRTdGF0ZSgpO1xuICAgICAgICBsZXQgY3VycmVudENsaXBJbmRleCA9IGFwanNTdG9yZVN0YXRlLmNsaXBMaXN0UmVkdWNlci5jdXJyZW50Q2xpcEluZGV4IHx8IDA7XG4gICAgICAgIGlmIChjdXJyZW50Q2xpcEluZGV4ID4gMCkge1xuICAgICAgICAgICAgc2FtcGxlVmlkZW9QbGF5ZXIucGxheSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXBqc1N0b3JlLmRpc3BhdGNoKHVwZGF0ZUNsaXBMaXN0KENsaXBMaXN0LCAwKSk7XG4gICAgbG9hZFZpZGVvU3JjKHNhbXBsZVZpZGVvUGxheWVyKTtcbiAgICB0aW1lbGluZVN0b3JlLnN1YnNjcmliZShvblRpbWVVcGRhdGUpO1xuICAgIEJlYWNvblV0aWxzLndhdGNoQmVhY29uVGltZWxpbmUoKTtcbn0pO1xuXG5mdW5jdGlvbiBsb2FkVmlkZW9TcmMoc2FtcGxlVmlkZW9QbGF5ZXIpIHtcbiAgICBsZXQgYXBqc1N0b3JlU3RhdGUgPSBhcGpzU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICBpZiAoYXBqc1N0b3JlU3RhdGUuY2xpcExpc3RSZWR1Y2VyKSB7XG4gICAgICAgIGxldCBjbGlwTGlzdEZyb21TdG9yZSA9IGFwanNTdG9yZVN0YXRlLmNsaXBMaXN0UmVkdWNlci5jbGlwTGlzdDtcbiAgICAgICAgbGV0IGN1cnJlbnRDbGlwSW5kZXggPSBhcGpzU3RvcmVTdGF0ZS5jbGlwTGlzdFJlZHVjZXIuY3VycmVudENsaXBJbmRleCB8fCAwO1xuICAgICAgICBsZXQgc291cmNlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzb3VyY2VcIik7XG4gICAgICAgIHNvdXJjZUVsZW1lbnQudHlwZSA9IFwidmlkZW8vbXA0XCI7XG4gICAgICAgIHNvdXJjZUVsZW1lbnQuc3JjID0gY2xpcExpc3RGcm9tU3RvcmVbY3VycmVudENsaXBJbmRleF0udXJsO1xuICAgICAgICBzYW1wbGVWaWRlb1BsYXllci5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgICBzYW1wbGVWaWRlb1BsYXllci5hcHBlbmRDaGlsZChzb3VyY2VFbGVtZW50KTtcbiAgICAgICAgaWYgKGN1cnJlbnRDbGlwSW5kZXggPiAwKSB7XG4gICAgICAgICAgICBzYW1wbGVWaWRlb1BsYXllci5sb2FkKClcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gaW5pdFRpbWVyKCkge1xuICAgIHRpbWVsaW5lSW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBsZXQgcHJldlBsYXllclRpbWUgPSB0aW1lbGluZVN0b3JlLmdldFN0YXRlKCkucGxheWVyVGltZTsgXG4gICAgICAgIGxldCBjdXJyZW50QVBKU1RpbWUgPSBzYW1wbGVWaWRlb1BsYXllci5jdXJyZW50VGltZTtcbiAgICAgICAgbGV0IGN1cnJlbnRQbGF5ZXJTdGF0ZSA9IGFwanNTdG9yZS5nZXRTdGF0ZSgpLnBsYXllclN0YXRlO1xuICAgICAgICBpZiAoKGN1cnJlbnRBUEpTVGltZSAtIHByZXZQbGF5ZXJUaW1lKSA+IFNUQUxMRURfVEhSRVNIT0xEICYmIGN1cnJlbnRQbGF5ZXJTdGF0ZSAhPT0gcGxheWVyRW51bXMuU1RBTExFRCkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlN0YWxsIGRldGVjdGVkXCIpO1xuICAgICAgICAgICAgYXBqc1N0b3JlLmRpc3BhdGNoKHN0YWxsZWRTdGF0ZSgpKTtcbiAgICAgICAgfVxuICAgICAgICB0aW1lbGluZVN0b3JlLmRpc3BhdGNoKHRpbWVVcGRhdGUoaW50ZXJ2YWxUaW1lLCBjdXJyZW50QVBKU1RpbWUpKTtcbiAgICB9LCBpbnRlcnZhbFRpbWUpO1xufVxuXG5mdW5jdGlvbiBvblRpbWVVcGRhdGUoKSB7XG4gICAgbGV0IGN1cnJlbnRBUEpTVGltZU1TID0gdGltZWxpbmVTdG9yZS5nZXRTdGF0ZSgpLmFwanNUaW1lO1xuICAgIGxldCBjdXJyZW50QVBKU1RpbWVTZWNvbmRzID0gY29udmVydFRvU2Vjb25kcyhjdXJyZW50QVBKU1RpbWVNUyk7XG4gICAgbGV0IGN1cnJlbnRQbGF5ZXJUaW1lID0gdGltZWxpbmVTdG9yZS5nZXRTdGF0ZSgpLnBsYXllclRpbWU7XG5cbiAgICBpZiAoY3VycmVudEFQSlNUaW1lTVMgJSAxMDAwID09PSAwICYmIGN1cnJlbnRBUEpTVGltZU1TICE9PSAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGAxIHNlY29uZCBpbnRlcnZhbCBoYXBwZW5lZCEgQVBKU1RpbWU6ICR7Y3VycmVudEFQSlNUaW1lTVN9IG1zIFBsYXllclRpbWU6ICR7Y3VycmVudFBsYXllclRpbWV9IHNlY2ApO1xuICAgIH1cblxuICAgIGlmIChjdXJyZW50QVBKU1RpbWVTZWNvbmRzICUgMzAgPT09IDAgJiYgY3VycmVudEFQSlNUaW1lTVMgIT09IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coYDMwIHNlY29uZCBpbnRlcnZhbCBoYXBwZW5lZCEgQVBKU1RpbWU6ICR7Y3VycmVudEFQSlNUaW1lU2Vjb25kc30gc2VjIFBsYXllclRpbWU6ICR7Y3VycmVudFBsYXllclRpbWV9IHNlY2ApO1xuICAgIH1cblxuICAgIGlmIChjdXJyZW50QVBKU1RpbWVTZWNvbmRzICUgNjAgPT09IDAgJiYgY3VycmVudEFQSlNUaW1lTVMgIT09IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coYDEgbWludXRlIGludGVydmFsIGhhcHBlbmVkISBBUEpTVGltZTogJHtjdXJyZW50QVBKU1RpbWVTZWNvbmRzfSBzZWMgUGxheWVyVGltZTogJHtjdXJyZW50UGxheWVyVGltZX0gc2VjYCk7XG4gICAgfVxuXG4gICAgaWYgKGN1cnJlbnRBUEpTVGltZVNlY29uZHMgJSAzMDAgPT09IDAgJiYgY3VycmVudEFQSlNUaW1lTVMgIT09IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coYDUgbWludXRlIGludGVydmFsIGhhcHBlbmVkISBBUEpTVGltZTogJHtjdXJyZW50QVBKU1RpbWVTZWNvbmRzfSBzZWMgUGxheWVyVGltZTogJHtjdXJyZW50UGxheWVyVGltZX0gc2VjYCk7XG4gICAgfVxufSJdLCJzb3VyY2VSb290IjoiIn0=